<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<META NAME=KEYWORDS CONTENT="LocalJS Documentation JavaScript Trusted browser local access HTML CSS WPF COM .Net Windows API">
<META NAME=DESCRIPTION CONTENT="LocalJS Documentation, JavaScript in Trusted Browser. Fast, Easy and Low Cost. Develop Desktop Application with HTML/CSS/JavaScript, deployed and upgraded from web">
<title>LocalJS: How To ...</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<div class="site_header"><a href="/">LocalJS Site</a> | <a href="/docs/">Documentation Home</a> | <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">Downloads</a> | <a href="http://sourceforge.net/tracker/?group_id=359375" target="_blank">Report an Issue</a></div>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Getting&nbsp;Started</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
          <span class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </span><span class="right"></span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>How To ... </h1>  </div>
</div>
<div class="contents">
<div align="center"><em>Prev:</em> <a class="el" href="getting_started.html">Getting Started</a> | <em>Next:</em> <a class="el" href="tutorial_js4cpp.html">JavaScript Jump Start For C++ Programmers</a> | <a class="el" href="group___j_s_objects.html">LocalJS Objects</a> | <a class="el" href="index.html">Document Home</a> | <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">Download demo application</a></div><p>Quick jump link:</p>
<p><a class="el" href="howto.html#howto_start_up">LocalJS Start Up</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_start_local_js">How to start a LocalJS application?</a> </li>
<li><a class="el" href="howto.html#howto_access_objects">How to start to use LocalJS objects in JavaScript?</a> </li>
<li><a class="el" href="howto.html#howto_debug">How to debug JavaScript?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_browser_wnd">Play with Browser Window</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_move_wnd">How to move browser window around on desktop within JavaScript?</a> </li>
<li><a class="el" href="howto.html#howto_change_wnd_style">How to change browser window style (borders, title bars, etc) within JavaScript?</a> </li>
<li><a class="el" href="howto.html#howto_popup_msg">How to popup a message dialog better than JavaScript alert?</a> </li>
<li><a class="el" href="howto.html#howto_close_wnd">How to close browser window from within JavaScript?</a> </li>
<li><a class="el" href="howto.html#howto_confirm_close">How to popup a confirm dialog when user closes browser window?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_file_access">Folders and Files</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_user_data_folder">How to retrieve user data folder?</a> </li>
<li><a class="el" href="howto.html#howto_create_folder">How to create folder in disk?</a> </li>
<li><a class="el" href="howto.html#howto_save_2_file">How to save settings to disk files?</a> </li>
<li><a class="el" href="howto.html#howto_save_2_reg">How to save settings to registry?</a> </li>
<li><a class="el" href="howto.html#howto_utf_8">How to access file in utf-8 format?</a> </li>
<li><a class="el" href="howto.html#howto_browse_file">How to browse for a file?</a> </li>
<li><a class="el" href="howto.html#howto_browse_folder">How to browse for folder?</a> </li>
<li><a class="el" href="howto.html#howto_enum_file">How to enumerate files in a folder?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_navigation">Navigate Back and Forth</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_get_webbrowser">How to get WebBrowser object of current browser window?</a> </li>
<li><a class="el" href="howto.html#howto_nav_2_local">How to navigate from remote url to local url?</a> </li>
<li><a class="el" href="howto.html#howto_cancel_nav">How to cancel a navigation?</a> </li>
<li><a class="el" href="howto.html#howto_pass_para_2_nav_page">How to pass parameters to the next page navigate to?</a> </li>
<li><a class="el" href="howto.html#howto_data_lost_reload">How to prevent data from lost when page is reloaded?</a> </li>
<li><a class="el" href="howto.html#howto_f5">How to prevent page reloading caused by user pressing F5 key?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_new_wnd">Launching New Browser Window</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_new_wnd_by_js">How to launch a new LocalJS browser window from within JavaScript?</a> </li>
<li><a class="el" href="howto.html#howto_new_wnd_by_click">How to launch a new LocalJS browser window when user clicks a link?</a> </li>
<li><a class="el" href="howto.html#howto_interop_other_wnd">How to interop with JavaScript in other LocalJS browser window?</a> </li>
<li><a class="el" href="howto.html#howto_global_dict">How to make a variable global to JavaScript in all LocalJS browser windows?</a> </li>
<li><a class="el" href="howto.html#howto_shell_exec">How to open a url in system default browser?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_db">Database</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_access_db">How to access database?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_web_service">Call Web Service from any domain</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_call_ws">How to call web service from other domains?</a> </li>
<li><a class="el" href="howto.html#howto_json">How to parse JSON format web response?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_sys_info">Retrieve System Information</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_get_exe">How to get current exe file name?</a> </li>
<li><a class="el" href="howto.html#howto_wmi">How to get system information (for example, processors descriptions)?</a> </li>
<li><a class="el" href="howto.html#howto_enumerate">How to enumerate items in collection (e.g., Files) returned by system object (e.g., FileSystemObject)?</a></li>
</ul>
<p><a class="el" href="howto.html#howto_thread">Multithreading</a> </p>
<ul>
<li><a class="el" href="howto.html#howto_new_thread">How to start a new thread?</a> </li>
<li><a class="el" href="howto.html#howto_thread_end">How to tell if a thread has ended?</a> </li>
<li><a class="el" href="howto.html#howto_thread_sync">How to synchronize data access among threads?</a></li>
</ul>
<h2><a class="anchor" id="howto_start_up"></a>
LocalJS Start Up</h2>
<h3><a class="anchor" id="howto_start_local_js"></a>
How to start a LocalJS application?</h3>
<ul>
<li>Run the bootstrap program included in <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">LocalJS demo application</a>, both source files and pre-built exe file are available.</li>
</ul>
<p>Refer to <em>Detailed</em> <em>Section</em> of <a class="el" href="group___host_a_p_i.html">LocalJS Hosting API</a> for diagram and pseudo code illustrating the workflow.</p>
<h3><a class="anchor" id="howto_access_objects"></a>
How to start to use LocalJS objects in JavaScript?</h3>
<ul>
<li>Root object <a class="el" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a> is globally available in LocalJS browser. </li>
<li>All other LocalJS objects derive from properies of <a class="el" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a> object, or properies and methods of derived objects:</li>
</ul>
<div class="fragment"><pre class="fragment">    var dllCall = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&#39;DllCall&#39;</span>);
    var thr = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.threading.newThread(<span class="stringliteral">&#39;return true;&#39;</span>);
    var globalDict = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.globalDict;
</pre></div><h3><a class="anchor" id="howto_debug"></a>
How to debug JavaScript?</h3>
<p>There are several JavaScript debug tools on web. Here is one of the solutions using Microsoft IDE:</p>
<ul>
<li>Install one of <a href="http://msdn.microsoft.com/en-us/library/5hs4b7a6.aspx" target="_blank">Just-In-Time</a> debuggers for JavaScript. For example, Visual Studio or <a href="http://msdn.microsoft.com/en-us/library/aa189846(office.10).aspx" target="_blank">Microsoft Script Editor</a>. <dl class="user"><dt><b></b></dt><dd><a href="http://msdn.microsoft.com/en-us/library/5hs4b7a6.aspx" target="_blank">Just-In-Time</a> means when a breakpoint is hit, the debugger will popup and prompt to attach to the script for debugging. </dd></dl>
</li>
<li>In system registry, create a string type key <em>"Disable Script Debugger"</em> with value <em>"no"</em> under entry <em>HKEY_CURRENT_USER\Software\LocalJS\WebBrowser\Main</em>:</li>
</ul>
<div align="center">
<img src="debug_registry.JPG" alt="debug_registry.JPG"/>
<p><strong>Registry Setting for Debug</strong></p></div>
<ul>
<li>Add <code>debugger</code> statement to code to set a breakpoint: <div class="fragment"><pre class="fragment">    (function()
    {
        debugger;
    })();
</pre></div> </li>
<li>When <code>debugger</code> statement is executed, the <a href="http://msdn.microsoft.com/en-us/library/5hs4b7a6.aspx" target="_blank">Just-In-Time</a> debugger prompts for debugging as below:</li>
</ul>
<div align="center">
<img src="debug_popup.JPG" alt="debug_popup.JPG"/>
<p><strong>Prompt for Debug</strong></p></div>
 <dl class="user"><dt><b></b></dt><dd>Choose the debugger you want and click Yes to debug JavaScript with the IDE.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If you called <a class="el" href="group___host_a_p_i.html#ga7474b7f77001b41241fdadc926054645" title="Change the default registry used by LocalJS browser to save its own options.">setBrowserControlRegPath()</a> to change the registry entry for LocalJS browser, you will need to set the 'Disable Script Debugger' option under the registry postion you specified.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://msdn.microsoft.com/en-us/library/k2h50zzs(VS.80).aspx" target="_blank">How to: Enable Client-Side Script Debugging</a></dd></dl>
<h2><a class="anchor" id="howto_browser_wnd"></a>
Play with Browser Window</h2>
<h3><a class="anchor" id="howto_move_wnd"></a>
How to move browser window around on desktop within JavaScript?</h3>
<ul>
<li>Retrive window handle with <a class="el" href="interfacelocal_j_s.html#aa05066bf1c7f31ea898c0d2aed29eedb" title="ReadOnly. Returns the HWND handle of current browser window.">localJS.hostWnd</a>; </li>
<li>Call Windows API <a href="http://msdn.microsoft.com/en-us/library/ms633534(VS.85).aspx" target="_blank">MoveWindow</a> with <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object.</li>
</ul>
<p>Refer to <a class="el" href="interfacelocal_j_s.html#a3566d4b69cb659d2e22501a77bc5af32" title="ReadOnly. Returns the height of the bottom localJS bar in pixels.">localJS.btmBarHeight</a> for sample code.</p>
<h3><a class="anchor" id="howto_change_wnd_style"></a>
How to change browser window style (borders, title bars, etc) within JavaScript?</h3>
<ul>
<li>Retrive window handle with <a class="el" href="interfacelocal_j_s.html#aa05066bf1c7f31ea898c0d2aed29eedb" title="ReadOnly. Returns the HWND handle of current browser window.">localJS.hostWnd</a>; </li>
<li>Call Windows API <a href="http://msdn.microsoft.com/en-us/library/ms633591(VS.85).aspx" target="_blank">SetWindowLong</a> and <a href="http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx" target="_blank">SetWindowPos</a> with <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object:</li>
</ul>
<div class="fragment"><pre class="fragment">    var dllCall = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;DllCall&quot;</span>),

        SWP_FRAMECHANGED = 0x0020, <span class="comment">// constants can be found in MSDN</span>
        SWP_SHOWWINDOW = 0x0040,
        SWP_NOMOVE = 0x0002,
        SWP_NOSIZE = 0x0001,

        GWL_STYLE = -16,

        WS_POPUP = 0x80000000,
        WS_VISIBLE = 0x10000000,
        WS_SYSMENU = 0x00080000,

        hostWnd = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.hostWnd;

    dllCall.add(<span class="stringliteral">&quot;user32.dll&quot;</span>, <span class="stringliteral">&quot;LONG SetWindowLong(HWND hWnd, int nIndex, LONG dwNewLong);&quot;</span>);
    dllCall.add(<span class="stringliteral">&quot;user32.dll&quot;</span>, <span class="stringliteral">&quot;BOOL SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags);&quot;</span>);

    <span class="comment">// Hide window title bar and border</span>
    dllCall.SetWindowLong(hostWnd, GWL_STYLE, WS_POPUP | WS_VISIBLE | WS_SYSMENU);
    dllCall.SetWindowPos(hostWnd, HWND_TOP, 0, 0, 0, 0, SWP_FRAMECHANGED | SWP_SHOWWINDOW | SWP_NOMOVE | SWP_NOSIZE);
</pre></div><h3><a class="anchor" id="howto_popup_msg"></a>
How to popup a message dialog better than JavaScript alert?</h3>
<ul>
<li>Retrive window handle with <a class="el" href="interfacelocal_j_s.html#aa05066bf1c7f31ea898c0d2aed29eedb" title="ReadOnly. Returns the HWND handle of current browser window.">localJS.hostWnd</a>; </li>
<li>Call Windows API <a href="http://msdn.microsoft.com/en-us/library/ms645505(VS.85).aspx" target="_blank">MessageBox</a> with <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object. </li>
<li>Alternatively, simply use HTML dialog provided by JavaScript libraries, which is much nicer and more controlable.</li>
</ul>
<p>Refer to <em>Detailed</em> <em>Description</em> of <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object for sample code.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://developer.yahoo.com/yui/container/dialog/" target="_blank">YUI Dialog</a> | <a href="http://docs.jquery.com/UI/Dialog" target="_blank">jQuery Dialog</a></dd></dl>
<h3><a class="anchor" id="howto_close_wnd"></a>
How to close browser window from within JavaScript?</h3>
<ul>
<li>Call method <a class="el" href="interfacelocal_j_s.html#ae0a273e38f45d2547157ddb6cfa6108c" title="Close the current browser window. NOT available in standalone Internet Explorer application.">localJS.closeWindow</a> to close browser window from with JavaScript.</li>
</ul>
<p>Refer to <a class="el" href="interfacelocal_j_s.html#ae0a273e38f45d2547157ddb6cfa6108c" title="Close the current browser window. NOT available in standalone Internet Explorer application.">localJS.closeWindow</a> for sample code.</p>
<h3><a class="anchor" id="howto_confirm_close"></a>
How to popup a confirm dialog when user closes browser window?</h3>
<p>To catch JavaScript call <code>window.close()</code>: </p>
<ul>
<li>Get <code>WebBrowser</code> object of current browser through property <a class="el" href="interfacelocal_j_s.html#a426d92f4370abff654c9a85a060c25c9" title="Readonly. Returns WebBrowser Object of current browser. Help transparently moving forth and back betw...">localJS.webBrowser</a>. </li>
<li>Use <a class="el" href="interface_c_o_m.html#a03b548ce8da020a692d590d4a5b21247" title="Connect JavaScript functions to COM object events.">COM.connectEvents</a> to hook <code>WindowClosing</code> event fired by <code>WebBrowser</code> object.</li>
</ul>
<dl class="user"><dt><b></b></dt><dd>Refer to <a class="el" href="interfacelocal_j_s.html#ae0a273e38f45d2547157ddb6cfa6108c" title="Close the current browser window. NOT available in standalone Internet Explorer application.">localJS.closeWindow</a> for sample code.</dd></dl>
<p>To catch close window action from user: </p>
<ul>
<li>Get <code>HWND</code> handle to current browser window through property <a class="el" href="interfacelocal_j_s.html#aa05066bf1c7f31ea898c0d2aed29eedb" title="ReadOnly. Returns the HWND handle of current browser window.">localJS.hostWnd</a>. </li>
<li>Use <a class="el" href="interface_window_hook.html" title="Hook messages of the specified window.">WindowHook</a> object to hook <code>WM_CLOSE</code> message of <a class="el" href="interfacelocal_j_s.html#aa05066bf1c7f31ea898c0d2aed29eedb" title="ReadOnly. Returns the HWND handle of current browser window.">localJS.hostWnd</a></li>
</ul>
<dl class="user"><dt><b></b></dt><dd>Refer to <em>Detailed</em> <em>Description</em> of <a class="el" href="interface_window_hook.html" title="Hook messages of the specified window.">WindowHook</a> object for sample code.</dd></dl>
<h2><a class="anchor" id="howto_file_access"></a>
Folders and Files</h2>
<h3><a class="anchor" id="howto_user_data_folder"></a>
How to retrieve user data folder?</h3>
<ul>
<li>Create <a href="http://msdn.microsoft.com/en-us/library/bb774094(VS.85).aspx" target="_blank">Shell Object</a> with method <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Call <a href="http://msdn.microsoft.com/en-us/library/bb774085(VS.85).aspx" target="_blank">Shell.NameSpace method</a> to get the user data folder.</li>
</ul>
<p>Refer to <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a> for an example.</p>
<h3><a class="anchor" id="howto_create_folder"></a>
How to create folder in disk?</h3>
<ul>
<li>Create <a href="http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx" target="_blank">FileSystemObject</a> with method <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Call <a href="http://msdn.microsoft.com/en-us/library/7kby5ae3(VS.85).aspx" target="_blank">CreateFolder method</a> of <a href="http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx" target="_blank">FileSystemObject</a> to create folder.</li>
</ul>
<p>Refer to <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a> for an example.</p>
<h3><a class="anchor" id="howto_save_2_file"></a>
How to save settings to disk files?</h3>
<ul>
<li>
To use INI file to save settings: <ul>
<li>
Create <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>
Call Windows API <a href="http://msdn.microsoft.com/en-us/library/ms724353(VS.85).aspx" target="_blank">GetPrivateProfileString</a>, <a href="http://msdn.microsoft.com/en-us/library/ms724345(VS.85).aspx" target="_blank">GetPrivateProfileInt</a> and <a href="http://msdn.microsoft.com/en-us/library/ms725501(VS.85).aspx" target="_blank">WritePrivateProfileString</a> using <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object: </li>
</ul>
</li>
</ul>
<div class="fragment"><pre class="fragment">    var dllCall = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;DllCall&quot;</span>);

    dllCall.add(<span class="stringliteral">&quot;Kernel32.dll&quot;</span>, <span class="stringliteral">&quot;UINT WINAPI GetPrivateProfileInt(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in INT nDefault,__in LPCTSTR lpFileName);&quot;</span>);
    dllCall.add(<span class="stringliteral">&quot;Kernel32.dll&quot;</span>, <span class="stringliteral">&quot;DWORD WINAPI GetPrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpDefault,__out LPTSTR lpReturnedString,__in DWORD nSize,__in LPCTSTR lpFileName);&quot;</span>);
    dllCall.add(<span class="stringliteral">&quot;Kernel32.dll&quot;</span>, <span class="stringliteral">&quot;BOOL WINAPI WritePrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpString,__in LPCTSTR lpFileName);&quot;</span>);

    var int_val = dllCall.GetPrivateProfileInt(<span class="stringliteral">&quot;section&quot;</span>, <span class="stringliteral">&quot;key&quot;</span>, 1, <span class="stringliteral">&quot;filename&quot;</span>);

    var str = dllCall.newBuffer(4096);
    <span class="comment">// localJS default uses UNICODE version of Windows API, so the passed in buffer size is by characters, not by bytes</span>
    var read_ok = dllCall.GetPrivateProfileString(<span class="stringliteral">&quot;section&quot;</span>, <span class="stringliteral">&quot;key&quot;</span>, NULL, str, str.size &gt;&gt; 1, <span class="stringliteral">&quot;filename&quot;</span>);
    <span class="keywordflow">if</span> (read_ok)
        alert(str);

    dllCall.WritePrivateProfileString(<span class="stringliteral">&quot;section&quot;</span>, <span class="stringliteral">&quot;key&quot;</span>, <span class="stringliteral">&quot;value&quot;</span>, <span class="stringliteral">&quot;filename&quot;</span>);
</pre></div><ul>
<li>To save general text file into files, create <a href="http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx" target="_blank">FileSystemObject</a> with method <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>:</li>
</ul>
<div class="fragment"><pre class="fragment">    var fso = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;Scripting.FileSystemObject&quot;</span>),
        ForWriting = 2; <span class="comment">// constant value found in documentation of OpenTextFile method in MSDN</span>

    var f = fso.OpenTextFile(<span class="stringliteral">&quot;c:\\test.txt&quot;</span>, ForWriting, <span class="keyword">true</span>);
    f.WriteLine(<span class="stringliteral">&quot;Write from JavaScript&quot;</span>);
    f.Close();
</pre></div><dl class="user"><dt><b></b></dt><dd>Refer to <a class="el" href="interface_threading.html#ab83b569dcb6b1ed35d6e9f13a8376a64" title="Create new script thread with optional arguments. Returns Thread object represents the new thread...">Threading.newThread</a> for sample code reading text file with <a href="http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx" target="_blank">FileSystemObject</a>.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="interface_dll_call.html#ab6730ea57a7678c1f07953ce331edca0" title="Add function exported by DLL or EXE file as a method of current DllCall object.">DllCall.add</a> | <a class="el" href="interface_dll_call.html#af9c99ab123bbf569e623a9c5e5c9f40e" title="Create a Buffer object, optionaly initialized it to given value.">DllCall.newBuffer</a> | <a class="el" href="interface_buffer.html" title="Buffer object represents a fixed size buffer, used as parameters in Dll function call.">Buffer</a> | <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a></dd></dl>
<h3><a class="anchor" id="howto_save_2_reg"></a>
How to save settings to registry?</h3>
<ul>
<li>Create <a href="http://msdn.microsoft.com/en-us/library/aew9yb99(VS.85).aspx" target="_blank">WshShell Object</a> with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>:</li>
</ul>
<div class="fragment"><pre class="fragment">    var shell = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;WScript.Shell&quot;</span>);
    var val = shell.RegRead(path_to_registry_entry);
    shell.RegWrite(path_to_registry_entry, val);
</pre></div><h3><a class="anchor" id="howto_utf_8"></a>
How to access file in utf-8 format?</h3>
<ul>
<li>Create <a href="http://msdn.microsoft.com/en-us/library/ms675032(VS.85).aspx" target="_blank">Stream Object (ADO)</a> with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Use <a href="http://msdn.microsoft.com/en-us/library/ms675032(VS.85).aspx" target="_blank">Stream Object (ADO)</a> to read and write utf-8 format files.</li>
</ul>
<div class="fragment"><pre class="fragment">    var objStream = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;ADODB.Stream&quot;</span>);
        adSaveCreateOverWrite = 2; <span class="comment">// constants value found in documentation of SaveOptionsEnum in MSDN</span>

    objStream.Open();
    objStream.Charset = <span class="stringliteral">&quot;utf-8&quot;</span>;
    objStream.WriteText(<span class="stringliteral">&quot;utf-8 string&quot;</span>);
    objStream.SaveToFile(<span class="stringliteral">&quot;C:\\test.txt&quot;</span>, adSaveCreateOverWrite);
    objStream.Close();
</pre></div><p>Refer to <a class="el" href="interface_threading.html#ab83b569dcb6b1ed35d6e9f13a8376a64" title="Create new script thread with optional arguments. Returns Thread object represents the new thread...">Threading.newThread</a> for sample code reading utf-8 format file.</p>
<h3><a class="anchor" id="howto_browse_file"></a>
How to browse for a file?</h3>
<ul>
<li>Create <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object through <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Call Windows API <a href="http://msdn.microsoft.com/en-us/library/ms646927(VS.85).aspx" target="_blank">GetOpenFileName</a> with <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object.</li>
</ul>
<p>To fill the parameter of <a href="http://msdn.microsoft.com/en-us/library/ms646927(VS.85).aspx" target="_blank">GetOpenFileName</a>, which is a pointer to <a href="http://msdn.microsoft.com/en-us/library/ms646839(VS.85).aspx" target="_blank">OPENFILENAME structure</a>:</p>
<ul>
<li>Create <a class="el" href="interface_structure.html" title="Structure object represents a C struct, used as parameters in Dll function call.">Structure</a> object with <a class="el" href="interface_dll_call.html#ac5fb73dfc65171de9e56b090a56b1269" title="Create an empty Structure object.">DllCall.newStruct</a> method; </li>
<li>Filling fields in with methods <a class="el" href="interface_structure.html#a0ce42643bb28edae3ef95829c7257d18" title="Append field to Structure object, optionally specify field name.">Structure.add</a>, <a class="el" href="interface_structure.html#a9281de28bee204692288a33173e38568" title="Append a 4 bytes field to Structure object, optionally specify initial value and field name...">Structure.addLong</a> and <a class="el" href="interface_structure.html#add3df9b88b7ecc45ee30cd9969020c28" title="Append a 2 bytes field to Structure object, optionally specify initial value and field name...">Structure.addShort</a> to represent <a href="http://msdn.microsoft.com/en-us/library/ms646839(VS.85).aspx" target="_blank">OPENFILENAME</a>. <dl class="user"><dt><b></b></dt><dd>For field members who are buffers, add a <a class="el" href="interface_buffer.html" title="Buffer object represents a fixed size buffer, used as parameters in Dll function call.">Buffer</a> object created by <a class="el" href="interface_dll_call.html#af9c99ab123bbf569e623a9c5e5c9f40e" title="Create a Buffer object, optionaly initialized it to given value.">DllCall.newBuffer</a>. </dd></dl>
</li>
<li>Pass the <a class="el" href="interface_structure.html" title="Structure object represents a C struct, used as parameters in Dll function call.">Structure</a> object to <a href="http://msdn.microsoft.com/en-us/library/ms646927(VS.85).aspx" target="_blank">GetOpenFileName</a> through <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object.</li>
</ul>
<p>Refer to <a class="el" href="interface_structure.html#a0ce42643bb28edae3ef95829c7257d18" title="Append field to Structure object, optionally specify field name.">Structure.add</a> for the example code. It's a bit long because <a href="http://msdn.microsoft.com/en-us/library/ms646839(VS.85).aspx" target="_blank">OPENFILENAME</a> is a big structure.</p>
<h3><a class="anchor" id="howto_browse_folder"></a>
How to browse for folder?</h3>
<ul>
<li>Create <a href="http://msdn.microsoft.com/en-us/library/bb774094(VS.85).aspx" target="_blank">Shell Object</a> with method <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Call <a href="http://msdn.microsoft.com/en-us/library/bb774065(VS.85).aspx" target="_blank">Shell.BrowseForFolder method</a>:</li>
</ul>
<div class="fragment"><pre class="fragment">    var shellApp = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;Shell.Application&quot;</span>),
        retVal = shellApp.BrowseForFolder(<a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.hostWnd, <span class="stringliteral">&quot;Title&quot;</span>, 0);
</pre></div><h3><a class="anchor" id="howto_enum_file"></a>
How to enumerate files in a folder?</h3>
<ul>
<li>Create <a href="http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx" target="_blank">FileSystemObject</a> with method <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Call <a href="http://msdn.microsoft.com/en-us/library/f1xtf7ta(VS.85).aspx" target="_blank">GetFolder method</a> and <a href="http://msdn.microsoft.com/en-us/library/18b41306(VS.85).aspx" target="_blank">Files property</a> to return <a href="http://msdn.microsoft.com/en-us/library/wz72a8c0(VS.85).aspx" target="_blank">Files collection</a>. </li>
<li>Enumerate collection with <a class="el" href="interface_enumerator.html" title="Similar to Enumerator object in JScript, providing access to items in Collection object.">Enumerator</a> object created by <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a> method:</li>
</ul>
<div class="fragment"><pre class="fragment">    var fso = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;Scripting.FileSystemObject&quot;</span>),
        folder = fso.GetFolder(<span class="stringliteral">&quot;C:\\Program Files\\&quot;</span>),
        fc = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;Enumerator&quot;</span>, folder.Files),
        s = <span class="stringliteral">&quot;&quot;</span>;

    <span class="keywordflow">for</span> (; !fc.atEnd(); fc.moveNext())
    {
        s += fc.item();
        s += <span class="stringliteral">&quot;&lt;br&gt;&quot;</span>;
    }
    alert(s);
</pre></div><h2><a class="anchor" id="howto_navigation"></a>
Navigate Back and Forth</h2>
<h3><a class="anchor" id="howto_get_webbrowser"></a>
How to get WebBrowser object of current browser window?</h3>
<ul>
<li>It's quite straightforward with <a class="el" href="interfacelocal_j_s.html#a426d92f4370abff654c9a85a060c25c9" title="Readonly. Returns WebBrowser Object of current browser. Help transparently moving forth and back betw...">localJS.webBrowser</a> property:</li>
</ul>
<div class="fragment"><pre class="fragment">    var browser_obj = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.webBrowser;
</pre></div><h3><a class="anchor" id="howto_nav_2_local"></a>
How to navigate from remote url to local url?</h3>
<ul>
<li>Use <a href="http://msdn.microsoft.com/en-us/library/aa752093(VS.85).aspx" target="_blank">Navigate Method</a> of <a href="http://msdn.microsoft.com/en-us/library/aa752085(VS.85).aspx" target="_blank">WebBrowser Object</a>:</li>
</ul>
<div class="fragment"><pre class="fragment">    <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.webBrowser.Navigate(<span class="stringliteral">&quot;file:///C:/test.html&quot;</span>);
</pre></div><h3><a class="anchor" id="howto_cancel_nav"></a>
How to cancel a navigation?</h3>
<ul>
<li>Use <a class="el" href="interface_c_o_m.html#a03b548ce8da020a692d590d4a5b21247" title="Connect JavaScript functions to COM object events.">COM.connectEvents</a> method to connect to <a href="http://msdn.microsoft.com/en-us/library/aa768326(VS.85).aspx" target="_blank">BeforeNavigate2 event</a>, set <code>cancel.returnValue</code> to true:</li>
</ul>
<div class="fragment"><pre class="fragment">    var onBeforeNavigate2 = function(disp, url, flags, target, postData, headers, cancel)
    {
        cancel.returnValue = <span class="keyword">true</span>;
    };
    com.connectEvents(<a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.webBrowser, {<span class="stringliteral">&#39;BeforeNavigate2&#39;</span>:onBeforeNavigate2});
</pre></div><h3><a class="anchor" id="howto_pass_para_2_nav_page"></a>
How to pass parameters to the next page navigate to?</h3>
<p>When browser navigates, all JavaScript variables of the previous page are lost. But variables saved to <a class="el" href="interfacelocal_j_s.html#ae46e48b1edd261d9c6fc8a9116ae564d" title="ReadOnly. Returns a Dictionary Object associated with current browser window. An ideal persistent sto...">localJS.browserDict</a> remain unchanged.</p>
<ul>
<li>Save parameters to <a class="el" href="interfacelocal_j_s.html#ae46e48b1edd261d9c6fc8a9116ae564d" title="ReadOnly. Returns a Dictionary Object associated with current browser window. An ideal persistent sto...">localJS.browserDict</a> so the next page can access it.</li>
</ul>
<p>Refer to <a class="el" href="interfacelocal_j_s.html#ae46e48b1edd261d9c6fc8a9116ae564d" title="ReadOnly. Returns a Dictionary Object associated with current browser window. An ideal persistent sto...">localJS.browserDict</a> for an example.</p>
<h3><a class="anchor" id="howto_data_lost_reload"></a>
How to prevent data from lost when page is reloaded?</h3>
<p>When browser reloads, all JavaScript variables of the previous page are lost. But variables saved to <a class="el" href="interfacelocal_j_s.html#ae46e48b1edd261d9c6fc8a9116ae564d" title="ReadOnly. Returns a Dictionary Object associated with current browser window. An ideal persistent sto...">localJS.browserDict</a> remain unchanged.</p>
<ul>
<li>Use <a class="el" href="interfacelocal_j_s.html#ae46e48b1edd261d9c6fc8a9116ae564d" title="ReadOnly. Returns a Dictionary Object associated with current browser window. An ideal persistent sto...">localJS.browserDict</a> to prevent data from lost when page is reloaded:</li>
</ul>
<div class="fragment"><pre class="fragment">    var persist_data;

    window.attachEvent(<span class="stringliteral">&quot;onload&quot;</span>, function()
    {
        var browserDict = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.browserDict;
        <span class="keywordflow">if</span> (browserDict.Exists(<span class="stringliteral">&quot;key_to_persist_data&quot;</span>))
            persist_data = browserDict.Item(<span class="stringliteral">&quot;key_to_persist_data&quot;</span>);
    }};
    window.attachEvent(<span class="stringliteral">&quot;onunload&quot;</span>, function()
    {
        var browserDict = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.browserDict;
        browserDict.Item(<span class="stringliteral">&quot;key_to_persist_data&quot;</span>) = persist_data;
    }};
</pre></div><h3><a class="anchor" id="howto_f5"></a>
How to prevent page reloading caused by user pressing F5 key?</h3>
<p>Even with <a class="el" href="interfacelocal_j_s.html#ae46e48b1edd261d9c6fc8a9116ae564d" title="ReadOnly. Returns a Dictionary Object associated with current browser window. An ideal persistent sto...">localJS.browserDict</a>, it's still boring to handle unexpected page reloading caused by user pressing F5 key.</p>
<ul>
<li>Set <a class="el" href="interfacelocal_j_s.html#a29a79e553fe87184f3a6ed6a9e0b270f" title="Get or set a boolean value to control whether pressing F5 key reloads HTML page. Ignored by standalon...">localJS.enableF5</a> to <code>false</code> disables F5 key from reloading page.</li>
</ul>
<p>Refer to <a class="el" href="interfacelocal_j_s.html#a29a79e553fe87184f3a6ed6a9e0b270f" title="Get or set a boolean value to control whether pressing F5 key reloads HTML page. Ignored by standalon...">localJS.enableF5</a>.</p>
<h2><a class="anchor" id="howto_new_wnd"></a>
Launching New Browser Window</h2>
<h3><a class="anchor" id="howto_new_wnd_by_js"></a>
How to launch a new LocalJS browser window from within JavaScript?</h3>
<ul>
<li>Create <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object through <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Call <a class="el" href="group___host_a_p_i.html">LocalJS Hosting API</a> <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> function through <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object.</li>
</ul>
<p>Refer to <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> for an example.</p>
<h3><a class="anchor" id="howto_new_wnd_by_click"></a>
How to launch a new LocalJS browser window when user clicks a link?</h3>
<ul>
<li>Get <code>WebBrowser</code> object of current browser through property <a class="el" href="interfacelocal_j_s.html#a426d92f4370abff654c9a85a060c25c9" title="Readonly. Returns WebBrowser Object of current browser. Help transparently moving forth and back betw...">localJS.webBrowser</a>; </li>
<li>Connect to <a href="http://msdn.microsoft.com/en-us/library/aa768337(VS.85).aspx" target="_blank">NewWindow3 event</a> of the <code>WebBrowser</code> object with <a class="el" href="interface_c_o_m.html#a03b548ce8da020a692d590d4a5b21247" title="Connect JavaScript functions to COM object events.">COM.connectEvents</a>; </li>
<li>Set <code>disp.returnValue</code> to the <code>WebBrowser</code> object of a new created browser window.</li>
</ul>
<p>Refer to <a class="el" href="interface_c_o_m.html#a03b548ce8da020a692d590d4a5b21247" title="Connect JavaScript functions to COM object events.">COM.connectEvents</a> for an example of handling <a href="http://msdn.microsoft.com/en-us/library/aa768337(VS.85).aspx" target="_blank">NewWindow3 event</a>.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The <code>WebBrowser</code> object of new created browser window is retrieved through function <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> and <a class="el" href="interface_c_o_m.html#a9742cc74cdf0445008d4adb2adbaa0d3" title="Convert a raw IDispatch * pointer to an object usable in JavaScript.">COM.interface2Object</a>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Refer to <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> for an example showing how to get the <code>WebBrowser</code> object of new created browser window.</dd></dl>
<h3><a class="anchor" id="howto_interop_other_wnd"></a>
How to interop with JavaScript in other LocalJS browser window?</h3>
<ul>
<li>Get the <code>WebBrowser</code> object of new created browser window through function <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> and <a class="el" href="interface_c_o_m.html#a9742cc74cdf0445008d4adb2adbaa0d3" title="Convert a raw IDispatch * pointer to an object usable in JavaScript.">COM.interface2Object</a>. </li>
<li>Get the <a href="http://www.javascriptkit.com/jsref/window.shtml" target="_blank">JavaScript Window object</a> of the new LocalJS browser page: <div class="fragment"><pre class="fragment">    var new_window = browser_obj.Document.parentWindow;
</pre></div> </li>
<li>Access <em>global</em> functions and variables in the new LocalJS browser page through properties of <a href="http://www.javascriptkit.com/jsref/window.shtml" target="_blank">JavaScript Window object</a> of the new LocalJS browser page: <div class="fragment"><pre class="fragment">    var new_window_func = new_window.function_name; <span class="comment">// assuming function_name is a global function name in the new page</span>
    var new_window_variable = new_window.variable_name; <span class="comment">// assuming variable_name is a global variable name in the new page</span>
</pre></div> </li>
<li>Now the JavaScript inside two LocalJS browser windows can interop each other as in same page.</li>
</ul>
<p>Refer to <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> for example code.</p>
<h3><a class="anchor" id="howto_global_dict"></a>
How to make a variable global to JavaScript in all LocalJS browser windows?</h3>
<ul>
<li>Save global variable to <a class="el" href="interfacelocal_j_s.html#a3db8e9f0672a2aed8a468da67db3b2e1" title="ReadOnly. Returns a Dictionary Object globally available in the process. An ideal global persistent s...">localJS.globalDict</a>.</li>
</ul>
<p>Refer to <a class="el" href="interfacelocal_j_s.html#a3db8e9f0672a2aed8a468da67db3b2e1" title="ReadOnly. Returns a Dictionary Object globally available in the process. An ideal global persistent s...">localJS.globalDict</a> for an example.</p>
<h3><a class="anchor" id="howto_shell_exec"></a>
How to open a url in system default browser?</h3>
<ul>
<li>Create <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Call <a href="http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx" target="_blank">ShellExecute function</a> with <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object:</li>
</ul>
<div class="fragment"><pre class="fragment">    var dllCall = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&#39;DllCall&#39;</span>);
    dllCall.add(<span class="stringliteral">&quot;shell32.dll&quot;</span>, <span class="stringliteral">&quot;HINSTANCE ShellExecute(HWND hwnd,LPCTSTR lpOperation,LPCTSTR lpFile,LPCTSTR lpParameters,LPCTSTR lpDirectory,INT nShowCmd);&quot;</span>);
    dllCall.ShellExecute(0, 0, <span class="stringliteral">&quot;http://localjs.org/&quot;</span>, 0, 0, 1);
</pre></div><h2><a class="anchor" id="howto_db"></a>
Database</h2>
<h3><a class="anchor" id="howto_access_db"></a>
How to access database?</h3>
<ul>
<li>Create <a href="http://www.w3schools.com/ado/ado_ref_connection.asp" target="_blank">ADO Connection object</a> with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Use properties and methods of <a href="http://www.w3schools.com/ado/ado_ref_connection.asp" target="_blank">ADO Connection object</a> to access database just like in other scripting languages.</li>
</ul>
<p>Code below opens an <a href="http://www.w3schools.com/ado/ado_ref_connection.asp" target="_blank">ADO Connection</a> to an excel <a href="file:">file:</a></p>
<div class="fragment"><pre class="fragment">    var openExcelFile = function(excel_file)
    {
        var cn = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;ADODB.Connection&quot;</span>);
        cn.Provider = <span class="stringliteral">&quot;Microsoft.Jet.OLEDB.4.0&quot;</span>;
        cn.ConnectionString = <span class="stringliteral">&quot;Data Source=&quot;</span> + excel_file + <span class="stringliteral">&quot;;Extended Properties=Excel 8.0;&quot;</span>
        cn.Open();
    }
</pre></div><h2><a class="anchor" id="howto_web_service"></a>
Call Web Service from any domain</h2>
<h3><a class="anchor" id="howto_call_ws"></a>
How to call web service from other domains?</h3>
<ul>
<li>Create <a href="http://msdn.microsoft.com/en-us/library/ms535874(VS.85).aspx" target="_blank">XMLHttpRequest object</a> with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>Use properies and methods of <a href="http://msdn.microsoft.com/en-us/library/ms535874(VS.85).aspx" target="_blank">XMLHttpRequest object</a> to access url from any domain.</li>
</ul>
<div class="fragment"><pre class="fragment">    var oHttp = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&quot;Microsoft.XMLHTTP&quot;</span>);
    oHttp.open(<span class="stringliteral">&quot;GET&quot;</span>, <span class="stringliteral">&quot;http://www.example.com/example.php&quot;</span>);
    oHttp.send();
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>There is no domain limitations on this <a href="http://msdn.microsoft.com/en-us/library/ms535874(VS.85).aspx" target="_blank">XMLHttpRequest object</a>.</dd></dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd><em>DO</em> <em>NOT</em> use <a href="http://msdn.microsoft.com/en-us/library/dd576252(VS.85).aspx" target="_blank">onreadystatechange event</a> of <a href="http://msdn.microsoft.com/en-us/library/ms535874(VS.85).aspx" target="_blank">XMLHttpRequest object</a>, it causes memory leak.</dd></dl>
<dl class="user"><dt><b></b></dt><dd>Use a timer to check the <a href="http://msdn.microsoft.com/en-us/library/ms534361(VS.85).aspx" target="_blank">readyState property</a> of <a href="http://msdn.microsoft.com/en-us/library/ms535874(VS.85).aspx" target="_blank">XMLHttpRequest object</a> instead: <div class="fragment"><pre class="fragment">    var fnOnDownloadOK = function()
    {
        alert(<span class="stringliteral">&quot;download OK&quot;</span>);
    };
    var fnOnDownloadFailed = function()
    {
        alert(<span class="stringliteral">&quot;download failed&quot;</span>);
    };
    var fnPullReadyState = function()
    {
        <span class="keywordflow">if</span> (4 == oHttp.readyState)
        {
            <span class="keywordflow">if</span> (200 == oHttp.status)
                fnOnDownloadOK(oHttp);
            <span class="keywordflow">else</span>
                fnOnDownloadFailed(oHttp);
        }
        <span class="keywordflow">else</span>
            setTimeout(fnPullReadyState, 1000);
    };

    setTimeout(fnPullReadyState, 1000);
</pre></div></dd></dl>
<h3><a class="anchor" id="howto_json"></a>
How to parse JSON format web response?</h3>
<p>Refer to <a class="el" href="tutorial_js4cpp.html#js4cpp_json">Build in JSON Parser</a>.</p>
<h2><a class="anchor" id="howto_sys_info"></a>
Retrieve System Information</h2>
<h3><a class="anchor" id="howto_get_exe"></a>
How to get current exe file name?</h3>
<ul>
<li>
Create <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a>; </li>
<li>
Call <a href="http://msdn.microsoft.com/en-us/library/ms683197(VS.85).aspx" target="_blank">GetModuleFileName function</a> through <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object. <dl class="user"><dt><b></b></dt><dd>For parameter <em>lpFilename</em> of <a href="http://msdn.microsoft.com/en-us/library/ms683197(VS.85).aspx" target="_blank">GetModuleFileName function</a>, pass with a <a class="el" href="interface_buffer.html" title="Buffer object represents a fixed size buffer, used as parameters in Dll function call.">Buffer</a> object created with <a class="el" href="interface_dll_call.html#af9c99ab123bbf569e623a9c5e5c9f40e" title="Create a Buffer object, optionaly initialized it to given value.">DllCall.newBuffer</a> method. </dd></dl>
</li>
</ul>
<p>Refer to <a class="el" href="interface_dll_call.html#af9c99ab123bbf569e623a9c5e5c9f40e" title="Create a Buffer object, optionaly initialized it to given value.">DllCall.newBuffer</a> for an example.</p>
<h3><a class="anchor" id="howto_wmi"></a>
How to get system information (for example, processors descriptions)?</h3>
<ul>
<li>Get instance of <a href="http://technet.microsoft.com/en-us/library/bb684728.aspx" target="_blank">Windows Management Instrumentation (WMI) object</a> through <a class="el" href="interface_c_o_m.html#aa5d75d3298d5de451ecbead91d92b32d" title="Get reference to COM object by displayName, optionally specify ProgID for the object to be created...">COM.getObject</a>; </li>
<li>Retrieve system information through <a href="http://technet.microsoft.com/en-us/library/bb684728.aspx" target="_blank">WMI object</a>; </li>
<li>Create <a class="el" href="interface_enumerator.html" title="Similar to Enumerator object in JScript, providing access to items in Collection object.">Enumerator</a> object with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a> method to enumerate collection returned by <a href="http://technet.microsoft.com/en-us/library/bb684728.aspx" target="_blank">WMI object</a>.</li>
</ul>
<p>Refer to <a class="el" href="interface_c_o_m.html#aa5d75d3298d5de451ecbead91d92b32d" title="Get reference to COM object by displayName, optionally specify ProgID for the object to be created...">COM.getObject</a> for an example.</p>
<h3><a class="anchor" id="howto_enumerate"></a>
How to enumerate items in collection (e.g., Files) returned by system object (e.g., FileSystemObject)?</h3>
<ul>
<li>Create <a class="el" href="interface_enumerator.html" title="Similar to Enumerator object in JScript, providing access to items in Collection object.">Enumerator</a> object with <a class="el" href="interface_c_o_m.html#a14285e3676c39b414cac2652046ec881" title="Create COM object by ProgID, optionally specify object location.">COM.createObject</a> method to enumerate collection returned by system object.</li>
</ul>
<p>Refer to <a class="el" href="howto.html#howto_enum_file">How to enumerate files in a folder?</a></p>
<h2><a class="anchor" id="howto_thread"></a>
Multithreading</h2>
<h3><a class="anchor" id="howto_new_thread"></a>
How to start a new thread?</h3>
<ul>
<li>Start new thread with method <a class="el" href="interface_threading.html#ab83b569dcb6b1ed35d6e9f13a8376a64" title="Create new script thread with optional arguments. Returns Thread object represents the new thread...">Threading.newThread</a>.</li>
</ul>
<p>Refer to <a class="el" href="interface_threading.html#ab83b569dcb6b1ed35d6e9f13a8376a64" title="Create new script thread with optional arguments. Returns Thread object represents the new thread...">Threading.newThread</a> for an example.</p>
<h3><a class="anchor" id="howto_thread_end"></a>
How to tell if a thread has ended?</h3>
<ul>
<li>Use property <a class="el" href="interface_thread.html#a2bb58b88ac256b165a95a806ae3b41e5" title="ReadOnly. Returns true if the thread is running, false if the thread has ended.">Thread.running</a>.</li>
</ul>
<p>Refer to <a class="el" href="interface_thread.html#a2bb58b88ac256b165a95a806ae3b41e5" title="ReadOnly. Returns true if the thread is running, false if the thread has ended.">Thread.running</a> for an example;</p>
<h3><a class="anchor" id="howto_thread_sync"></a>
How to synchronize data access among threads?</h3>
<ul>
<li>Thread synchronization becomes <em>EXTREMELY</em> <em>SIMPLE</em> for localJS script: you don't need to synchronize access to variables from different script threads; they will be synchronized automatically.</li>
</ul>
<p>Refer to section <em>Synchronization</em> of <a class="el" href="interface_threading.html#ab83b569dcb6b1ed35d6e9f13a8376a64" title="Create new script thread with optional arguments. Returns Thread object represents the new thread...">Threading.newThread</a> description.</p>
<div align="center"><em>Prev:</em> <a class="el" href="getting_started.html">Getting Started</a> | <em>Next:</em> <a class="el" href="tutorial_js4cpp.html">JavaScript Jump Start For C++ Programmers</a> | <a class="el" href="group___j_s_objects.html">LocalJS Objects</a> | <a class="el" href="index.html">Document Home</a> | <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">Download demo application</a></div> </div>
<hr class="footer"/><div class="footer"><a href="/">LocalJS Site</a> | <a href="/docs/">Documentation Home</a> | <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">Downloads</a> | <a href="http://sourceforge.net/tracker/?group_id=359375" target="_blank">Report an Issue</a></div>
</body>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18928254-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</html>
