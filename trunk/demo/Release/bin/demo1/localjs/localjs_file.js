(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var s=LOCALJS;if("undefined"!=typeof(s.FILE)){return}s.FILE={};var A=false,D=window,b=s.FILE,C=localJS,w=C.hostWnd,f=C.COM,J=f.createObject,G,r=function(){if(!G){G=J("Shell.Application")}return G},l,u=function(){if(!l){l=J("WScript.Shell")}return l},p,d=function(){if(!p){p=J("Scripting.FileSystemObject")}return p},z=function(K){return K?true:A},m=J("DllCall"),y=m.add,E=m.newStruct,a=m.newBuffer;y("shell32.dll","HINSTANCE ShellExecute(HWND hwnd,LPCTSTR lpOperation,LPCTSTR lpFile,LPCTSTR lpParameters,LPCTSTR lpDirectory,INT nShowCmd);");y("Kernel32.dll","UINT WINAPI GetPrivateProfileInt(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in INT nDefault,__in LPCTSTR lpFileName);");y("Kernel32.dll","DWORD WINAPI GetPrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpDefault,__out LPTSTR lpReturnedString,__in DWORD nSize,__in LPCTSTR lpFileName);");y("Kernel32.dll","BOOL WINAPI WritePrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpString,__in LPCTSTR lpFileName);");y("kernel32.dll","DWORD WINAPI GetModuleFileName(__in_opt HMODULE hModule,__out LPTSTR lpFilename,__in DWORD nSize);");y("comdlg32.dll","BOOL WINAPI GetOpenFileName(__inout LPOPENFILENAME lpofn);");y("shlwapi.dll","HRESULT UrlCombine(LPCTSTR pszBase,LPCTSTR pszRelative,LPTSTR pszCombined,LPDWORD pcchCombined,DWORD dwFlags);");y("urlmon.dll","STDAPI CoInternetParseUrl(LPCWSTR pwzUrl,PARSEACTION ParseAction,DWORD dwFlags,LPWSTR pszResult,DWORD cchResult,DWORD *pcchResult,DWORD dwReserved);","parseUrl");y("shlwapi.dll","BOOL UrlIs(LPCTSTR pszUrl,URLIS UrlIs);");y("shlwapi.dll","BOOL PathIsURL(LPCTSTR pszPath);");y("shlwapi.dll","HRESULT UrlCreateFromPath(LPCTSTR pszPath,LPTSTR pszUrl,LPDWORD pcchUrl,DWORD dwReserved);");var o=m.ShellExecute,B=m.GetPrivateProfileInt,j=m.GetPrivateProfileString,H=m.WritePrivateProfileString,q=m.GetModuleFileName,k=m.GetOpenFileName,c=m.UrlCombine,v=m.parseUrl,h=m.UrlIs,e=m.PathIsURL,n=m.UrlCreateFromPath,x=9,i=4200,F=3,g=5,I=4096,t=536870912;(function(){b.iniWrite=function(K,O,L,M){try{M=M.toString()}catch(N){M=0}H(O,L,M,K)};b.iniReadInt=function(L,N,M,K){if(!K){K=0}return B(N,M,K,L)};b.iniReadStr=function(L,O,M,K){try{K=K.toString()}catch(N){K=""}var P=a(4096);if(j(O,M,K,P,P.size>>1,L)){return P.asStringW}return K};b.regWrite=function(K,M,L){u().RegWrite(K,M,L)};b.regRead=function(K){return u().RegRead(K)};b.regDelete=function(K){u().RegDelete(K)};b.fileExists=function(K){return z(d().FileExists(K))};b.folderExists=function(K){return z(d().FolderExists(K))};b.getAppDataFolder=function(L){var K=r().Namespace(26).Self.Path;return L?d().BuildPath(K,L):K};b.getProgramFolder=function(L){var K=r().Namespace(38).Self.Path;return L?d().BuildPath(K,L):K};b.getExeFilename=function(){var K=a(1024);q(0,K,K.size>>1);return K.asStringW};b.getExeFolder=function(){return d().GetParentFolderName(b.getExeFilename())};b.buildPath=function(K,L){return d().BuildPath(K,L)};b.getParentFolder=function(K){return d().GetParentFolderName(K)};b.readFileUTF8=function(L){try{var N=J("ADODB.Stream");N.Open();N.Charset="utf-8";N.LoadFromFile(L);var K=N.ReadText();N.Close();return K}catch(M){return A}};b.writeFileUTF8=function(K,M){var L=J("ADODB.Stream");adSaveCreateOverWrite=2;L.Open();L.Charset="utf-8";L.WriteText(M);L.SaveToFile(K,adSaveCreateOverWrite);L.Close()};b.deleteFile=function(K,L){d().DeleteFile(K,L)};b.createFolder=function(K){if(!d().FolderExists(K)){d().CreateFolder(K)}};b.deleteFolder=function(K,L){d().DeleteFolder(K,L)};b.listFolder=function(M){var K=[];if(d().FolderExists(M)){var N=p.GetFolder(M),L=J("Enumerator",N.Files);for(;!L.atEnd();L.moveNext()){K.push(L.item())}}return K};b.browseFile=function(K,N,Q,M,P,R){var O=function(){var S=33554432,V=4096,T=2048,W=1,U=E().addLong("lStructSize").addLong(w).addLong("hInstance").add(a(512).address,"lpstrFilter").addLong("lpstrCustomFilter").addLong("nMaxCustFilter").addLong(1,"nFilterIndex").add(a(512).address,"lpstrFile").addLong("nMaxFile").addLong("lpstrFileTitle").addLong("nMaxFileTitle").add(a(512).address,"lpstrInitialDir").add(a(512).address,"lpstrTitle").addLong(S|V|T|(R?W:0),"Flags").addShort("nFileOffset").addShort("nFileExtension").add(a(128).address,"lpstrDefExt").add(a(24));U.lStructSize=U.size;return U},L=O();if(N){L.lpstrFilter=N}if(K){L.lpstrInitialDir=K}if(Q){L.lpstrTitle=Q}else{L.lpstrTitle=document.title}if(M){L.lpstrDefExt=M}if(P){L.lpstrFile=P}L.nMaxFile=L.lpstrFile.size>>1;if(k(L)){return L.lpstrFile.asStringW}return A};b.browseFolder=function(N,K){try{var M=r().BrowseForFolder(w,N?N:document.title,0,K).Self.Path;return d().FolderExists(M)?M:""}catch(L){return A}};b.exec=function(K){o(0,0,K,0,0,1)};b.pathToUrl=function(M){var K=a(i),L=a(4,K.size>>1);if(n(M,K,L,0)>=0){return K.asStringW}return A};b.urlToPath=function(L){var M=a(512),K=a(4);if(v(L,x,0,M,M.size>>1,K,0)>=0){return M.asStringW}return A};b.isUrl=function(K){return z(e(K))};b.isFileUrl=function(K){return z(h(K,F))};b.readUrl=function(L,S){if(h(L,F)){var T=b.urlToPath(L),N=A;if(A!==T&&b.fileExists(T)){N=b.readFileUTF8(T)}if(!S){return N}if(A===N){if(S.fail){S.fail(N)}}else{if(S.ok){S.ok(N)}}}else{var P=LOCALJS.WEB_SERVICE;if(S){P.callUrl("GET",L,S)}else{var O,R=A,M=function(U){O=1;R=U},K=function(){O=-1};for(var Q=0;Q<5;++Q){O=0;P.callUrl("GET",L,{ok:M,fail:K});while(0==O){if(!LOCALJS.UI.doEvents()){return A}}if(1==O){break}}return R}}};b.buildUrl=function(M,K){var L=a(i),N=a(4,L.size>>1);if(c(M,K,L,N,I|t)>=0){return L.asStringW}return A};b.normalizeUrl=function(K){var L=document.URL.replace(/[#\?].*$/,"");if(!K){return L}return b.buildUrl(L,K)}})()})();