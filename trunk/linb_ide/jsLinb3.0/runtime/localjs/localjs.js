(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var t=LOCALJS;t.FILE=t.FILE||{};var B=false,E=window,b=t.FILE,D=localJS,x=D.hostWnd,f=D.COM,K=f.createObject,H,r=function(){if(!H){H=K("Shell.Application")}return H},l,v=function(){if(!l){l=K("WScript.Shell")}return l},p,d=function(){if(!p){p=K("Scripting.FileSystemObject")}return p},A=function(L){return L?true:B},m=K("DllCall"),z=m.add,F=m.newStruct,a=m.newBuffer;z("shell32.dll","HINSTANCE ShellExecute(HWND hwnd,LPCTSTR lpOperation,LPCTSTR lpFile,LPCTSTR lpParameters,LPCTSTR lpDirectory,INT nShowCmd);");z("Kernel32.dll","UINT WINAPI GetPrivateProfileInt(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in INT nDefault,__in LPCTSTR lpFileName);");z("Kernel32.dll","DWORD WINAPI GetPrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpDefault,__out LPTSTR lpReturnedString,__in DWORD nSize,__in LPCTSTR lpFileName);");z("Kernel32.dll","BOOL WINAPI WritePrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpString,__in LPCTSTR lpFileName);");z("kernel32.dll","DWORD WINAPI GetModuleFileName(__in_opt HMODULE hModule,__out LPTSTR lpFilename,__in DWORD nSize);");z("comdlg32.dll","BOOL WINAPI GetOpenFileName(__inout LPOPENFILENAME lpofn);");z("comdlg32.dll","BOOL WINAPI GetSaveFileName(__inout LPOPENFILENAME lpofn);");z("shlwapi.dll","HRESULT UrlCombine(LPCTSTR pszBase,LPCTSTR pszRelative,LPTSTR pszCombined,LPDWORD pcchCombined,DWORD dwFlags);");z("urlmon.dll","STDAPI CoInternetParseUrl(LPCWSTR pwzUrl,PARSEACTION ParseAction,DWORD dwFlags,LPWSTR pszResult,DWORD cchResult,DWORD *pcchResult,DWORD dwReserved);","parseUrl");z("shlwapi.dll","BOOL UrlIs(LPCTSTR pszUrl,URLIS UrlIs);");z("shlwapi.dll","BOOL PathIsURL(LPCTSTR pszPath);");z("shlwapi.dll","HRESULT UrlCreateFromPath(LPCTSTR pszPath,LPTSTR pszUrl,LPDWORD pcchUrl,DWORD dwReserved);");var o=m.ShellExecute,C=m.GetPrivateProfileInt,j=m.GetPrivateProfileString,J=m.WritePrivateProfileString,q=m.GetModuleFileName,k=m.GetOpenFileName,s=m.GetSaveFileName,c=m.UrlCombine,w=m.parseUrl,h=m.UrlIs,e=m.PathIsURL,n=m.UrlCreateFromPath,y=9,i=4200,G=3,g=5,I=4096,u=536870912;(function(){b.iniWrite=function(L,P,M,N){try{N=N.toString()}catch(O){N=0}J(P,M,N,L)};b.iniReadInt=function(M,O,N,L){if(!L){L=0}return C(O,N,L,M)};b.iniReadStr=function(M,P,N,L){try{L=L.toString()}catch(O){L=""}var Q=a(4096);if(j(P,N,L,Q,Q.size>>1,M)){return Q.asStringW}return L};b.regWrite=function(L,N,M){v().RegWrite(L,N,M)};b.regRead=function(L){return v().RegRead(L)};b.regDelete=function(L){v().RegDelete(L)};b.fileExists=function(L){return A(d().FileExists(L))};b.folderExists=function(L){return A(d().FolderExists(L))};b.getAppDataFolder=function(M){var L=r().Namespace(26).Self.Path;return M?d().BuildPath(L,M):L};b.getProgramFolder=function(M){var L=r().Namespace(38).Self.Path;return M?d().BuildPath(L,M):L};b.getExeFilename=function(){var L=a(1024);q(0,L,L.size>>1);return L.asStringW};b.getExeFolder=function(){return d().GetParentFolderName(b.getExeFilename())};b.buildPath=function(L,M){return d().BuildPath(L,M)};b.getParentFolder=function(L){return d().GetParentFolderName(L)};b.getFileName=function(L){return d().GetFileName(L)};b.getBaseName=function(L){return d().GetBaseName(L)};b.getExtensionName=function(L){return d().GetExtensionName(L)};b.readFileUTF8=function(M){try{var O=K("ADODB.Stream");O.Open();O.Charset="utf-8";O.LoadFromFile(M);var L=O.ReadText();O.Close();return L}catch(N){return B}};b.writeFileUTF8=function(L,N){var M=K("ADODB.Stream");adSaveCreateOverWrite=2;M.Open();M.Charset="utf-8";M.WriteText(N);M.SaveToFile(L,adSaveCreateOverWrite);M.Close()};b.deleteFile=function(L,M){try{d().DeleteFile(L,M);return true}catch(N){return false}};b.createFolder=function(L){if(!d().FolderExists(L)){d().CreateFolder(L)}};b.deleteFolder=function(L,M){try{d().DeleteFolder(L,M);return true}catch(N){return false}};b.copyFile=function(N,L,M){d().CopyFile(N,L,!M)};b.copyFolder=function(N,L,M){d().CopyFolder(N,L,!M)};b.listFolder=function(N){var L=[];if(d().FolderExists(N)){var O=p.GetFolder(N),M=K("Enumerator",O.Files);for(;!M.atEnd();M.moveNext()){L.push(M.item())}}return L};b.browseFile=function(O,R,Q,M,P,N,T){var S=function(){var U=33554432,X=4096,V=2048,Y=1,W=F().addLong("lStructSize").addLong(x).addLong("hInstance").add(a(512).address,"lpstrFilter").addLong("lpstrCustomFilter").addLong("nMaxCustFilter").addLong(1,"nFilterIndex").add(a(512).address,"lpstrFile").addLong("nMaxFile").addLong("lpstrFileTitle").addLong("nMaxFileTitle").add(a(512).address,"lpstrInitialDir").add(a(512).address,"lpstrTitle").addLong(U|X|V|(T?Y:0),"Flags").addShort("nFileOffset").addShort("nFileExtension").add(a(128).address,"lpstrDefExt").add(a(24));W.lStructSize=W.size;return W},L=S();if(M){L.lpstrFilter=M}if(Q){L.lpstrInitialDir=Q}if(R){L.lpstrTitle=R}else{L.lpstrTitle=document.title}if(P){L.lpstrDefExt=P}if(N){L.lpstrFile=N}L.nMaxFile=L.lpstrFile.size>>1;if(O?s(L):k(L)){return L.lpstrFile.asStringW}return B};b.browseFolder=function(O,L){try{var N=r().BrowseForFolder(x,O?O:document.title,0,L).Self.Path;return d().FolderExists(N)?N:""}catch(M){return B}};b.exec=function(L){o(0,0,L,0,0,1)};b.pathToUrl=function(N){var L=a(i),M=a(4,L.size>>1);if(n(N,L,M,0)>=0){return L.asStringW}return B};b.urlToPath=function(M){var N=a(512),L=a(4);if(w(M,y,0,N,N.size>>1,L,0)>=0){return N.asStringW}return B};b.isUrl=function(L){return A(e(L))};b.isFileUrl=function(L){return A(h(L,G))};b.readUrl=function(M,T){if(h(M,G)){var U=b.urlToPath(M),O=B;if(B!==U&&b.fileExists(U)){O=b.readFileUTF8(U)}if(!T){return O}if(B===O){if(T.fail){T.fail(O)}}else{if(T.ok){T.ok(O)}}}else{var Q=LOCALJS.WEB_SERVICE;if(T){Q.callUrl("GET",M,T)}else{var P,S=B,N=function(V){P=1;S=V},L=function(){P=-1};for(var R=0;R<5;++R){P=0;Q.callUrl("GET",M,{ok:N,fail:L});while(0==P){if(!LOCALJS.UI.doEvents()){return B}}if(1==P){break}}return S}}};b.buildUrl=function(N,L){var M=a(i),O=a(4,M.size>>1);if(c(N,L,M,O,I|u)>=0){return M.asStringW}return B};b.normalizeUrl=function(L){var M=document.URL.replace(/[#\?].*$/,"");if(!L){return M}return b.buildUrl(M,L)}})()})();(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var i=LOCALJS;i.LOCALIZATION=i.LOCALIZATION||{};var j=i.LOCALIZATION,b=localJS.globalDict,c="LOCALJS.LOCALIZATION.CURRENT_LANG",g="lang",h="url",f="words",e="func_names",a=function(){return localJS.COM.createObject("Scripting.Dictionary")},k=function(){if(!b.Exists(c)){b.Item(c)=a()}return b.Item(c)},d=function(){var n=k();if(n.Exists(h)&&n.Exists(g)){var o=LOCALJS.FILE,t=o.buildUrl(n.Item(h),n.Item(g)+".json"),m=o.readUrl(t);if(m){try{var q=(new Function("return "+m))(),s=a(),r;for(var l in q){var u=q[l];if("function"==typeof(u)){u=u.toString();if(!r){r=a()}r.Item(l)=1}s.Item(l)=u}n.Item(f)=s;if(r){n.Item(e)=r}else{if(n.Exists(e)){n.Remove(e)}}return}catch(p){}}}if(n.Exists(f)){n.Remove(f)}if(n.Exists(e)){n.Remove(e)}};j.setPath=function(o,m){var n=k(),l=LOCALJS.FILE.normalizeUrl(o);if(!l.match(/\/$/)){l=l+"/"}if(!n.Exists(h)||l!=n.Item(h)||m){n.Item(h)=l;d()}};j.setLang=function(n,l){var m=k();if(!m.Exists(g)||n!=m.Item(g)||l){m.Item(g)=n;d()}};j.getLang=function(){var l=k();return l.Exists(g)?l.Item(g):undefined};j.get=function(m){var n=k(),p=n.Exists(f)?n.Item(f):undefined;if(p&&p.Exists(m)){var o=p.Item(m);if(n.Exists(e)){var l=n.Item(e);if(l.Exists(m)){return(new Function("return "+o))()}}return o}else{return m}};j.getAcceptLanguages=function(){var l=localJS.COM.createObject("DllCall"),m=l.newBuffer,o=m(512),n=m(4,o.size);l.add("shlwapi.dll","HRESULT GetAcceptLanguages(LPTSTR psz, LPDWORD pcch);","f");if(l.f(o,n)>=0){return o.asStringW}return false}})();(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var O=LOCALJS;O.UI=O.UI||{};var b=false,V=true,af=window,al=screen,J=O.UI,av=localJS,a=av.hostWnd,Z=av.webBrowser,B=av.COM,R=B.createObject,m=B.interface2Object,s=B.connectEvents,z=R("DllCall"),t=z.add,q=z.newStruct,p=z.newBuffer,w=function(aI,aH){return"undefined"==typeof(aI)?aH:aI},az=function(){return q().addLong("left").addLong("top").addLong("right").addLong("bottom")},aE=function(){return q().addLong("x").addLong("y")},x=function(){var aH=q().addLong("length").addLong("flags").addLong("showCmd").add(aE(),"ptMinPosition").add(aE(),"ptMaxPosition").add(az(),"rcNormalPosition");aH.length=aH.size;return aH},D=function(){return q().addLong("hwnd").addLong("message").addLong("wParam").addLong("lParam").addLong("time").add(q().addLong("x").addLong("y"),"pt")};t("user32.dll","BOOL GetMessage(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax);");t("user32.dll","BOOL TranslateMessage(const MSG *lpMsg);");t("user32.dll","LRESULT DispatchMessage(const MSG *lpmsg);");t("user32.dll","void PostQuitMessage(int nExitCode);");t("LocalJS.dll","BOOL __stdcall translateBrowserAccelerator(LPMSG lpmsg);");t("user32.dll","LRESULT SendMessage(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam);");t("user32.dll","int WINAPI MessageBox(HWND hWnd,LPCTSTR lpText,LPCTSTR lpCaption,UINT uType);");t("user32.dll","LONG SetWindowLong(HWND hWnd, int nIndex, LONG dwNewLong);");t("user32.dll","BOOL SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags);");t("user32.dll","BOOL SetForegroundWindow(HWND hWnd);");t("user32.dll","BOOL MoveWindow(HWND hWnd,int X,int Y,int nWidth,int nHeight,BOOL bRepaint);");t("user32.dll","BOOL GetWindowRect(HWND hWnd,LPRECT lpRect);");t("user32.dll","BOOL GetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");t("user32.dll","BOOL SetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");t("LocalJS.dll","void * __stdcall createBrowserWindow(DWORD dwStyle, int x, int y, int nWidth, int nHeight, HWND hWndParent, LPCWSTR url, VARIANT * const pVarResult);");t("LocalJS.dll","void __stdcall deleteBrowserWindow(void * browser)");t("LocalJS.dll","void __stdcall detachBrowserWindow(void * browser);");t("LocalJS.dll","IDispatch * __stdcall getBrowserObj(void * browser);");t("LocalJS.dll","BOOL __stdcall browserWindowClosed(void * browser);");t("LocalJS.dll","int __stdcall getBrowserType(void * browser);");t("LocalJS.dll","void * __stdcall createIE(LPCWSTR url);");t("LocalJS.dll","HWND __stdcall getBrowserHostWnd(void * browser);");var e=z.GetMessage,A=z.TranslateMessage,L=z.DispatchMessage,i=z.PostQuitMessage,at=z.translateBrowserAccelerator,g=z.SendMessage,an=z.MessageBox,o=z.SetWindowLong,T=z.SetWindowPos,ar=z.SetForegroundWindow,X=z.MoveWindow,Q=z.GetWindowRect,aD=z.GetWindowPlacement,aj=z.SetWindowPlacement,v=z.createBrowserWindow,l=z.deleteBrowserWindow,G=z.detachBrowserWindow,N=z.getBrowserObj,H=z.browserWindowClosed,M=z.getBrowserHostWnd,ab=z.getBrowserType,c=z.createIE,ag=1,n=2,r=-16,ak=0,aw=2147483648,h=12582912,P=524288,I=131072,aB=65536,au=268435456,E=262144,C=8388608,aF=ak|h|P|E|I|aB,aq=32,K=64,S=2,u=1,d=0,ao=16,aC=12,ap=2,W=16,ai=32,ay=48,aG=64,f=65536,am=8192,ax=262144,aA=1,y=4,ad=256,aa=512,j=W|f|ax|am,F=aG|f|ax|am,ac=ai|f|ax|am|y,ah=ai|f|ax|am|aA,U=1,Y=6,ae=0;J.WS_CLOSE_ONLY=aw|E|h|P|au;J.WS_NO_TITLE_BAR=aw|au|P;J.WS_NORMAL=aF|au;J.isIE=n==ab(av.browserWindowHandle);(function(){var aH=D();unloading=b;af.attachEvent("onunload",function(){unloading=V});J.doEvents=function(){if(unloading){return b}var aI=e(aH,0,0,0);if(0==aI){i(aH.wParam);return b}if(aI>0){if(!at(aH)){A(aH);L(aH)}}return V}})();(function(){var aI,aH=function(aJ){return aJ.getElementsByTagName("html")[0]};J.setDraggables=function(aJ){aI=aJ};J.addDraggable=function(){var aL=0,aK=arguments;for(;aL<aK.length;++aL){var aM=aK[aL];if("string"==typeof(aM)){aM=document.getElementById(aM)}if(aM){if(!aI){aI=[];var aN=document,aJ;if(aN){aI.push(aH(aN));aJ=aN.body}if(aJ){aI.push(aJ)}}aI.push(aM)}}};J.getDraggables=function(){return aI};af.attachEvent("onload",function(){var aS=document,aP=aS.body,aN=aH(aS);if(!aI){aI=[aP,aN]}var aQ=b,aJ=az(),aT,aR,aK,aV,aM=function(aW){if(aI&&aI.length){for(var aX=0;aX<aI.length;++aX){if(aI[aX]===aW){return V}}}return b},aO,aL="onlosecapture",aU=function(){aQ=b;if(aO){aO.detachEvent(aL,aU);aO=null}};aS.attachEvent("onmousedown",function(){aO=event.srcElement;if(!aQ&&(1&event.button)&&aM(aO)&&event.clientX<aN.clientWidth&&event.clientY<aN.clientHeight){aQ=V;aO.setCapture();aO.attachEvent(aL,aU);Q(a,aJ);aK=aJ.right-aJ.left;aV=aJ.bottom-aJ.top;aT=event.screenX;aR=event.screenY}});aS.attachEvent("onmousemove",function(){if(aQ){X(a,aJ.left+event.screenX-aT,aJ.top+event.screenY-aR,aK,aV,1)}});aS.attachEvent("onmouseup",function(){if(aQ&&aO){aO.releaseCapture()}})})})();var k=function(aM){var aJ=aM,aO=this,aH,aN;this.webBrowser=m(N(aJ));this.HWND=M(aJ);this.initFunction=null;this.isIE=n==ab(aJ);this.getHandle=function(){return aJ};this.close=function(aQ){if(aJ){var aP=aJ;aJ=0;aO.webBrowser=null;aO.HWND=0;if(aN){aN.unhook()}if(aH){aH.disconnect()}if(aQ){G(aP)}l(aP)}};this.isClosed=function(){return H(aJ)?V:b};this.getJSWindow=function(aP){aP=w(aP,10);var aQ=(new Date()).getTime()/1000;do{if(aO.webBrowser&&aO.webBrowser.Document){return aO.webBrowser.Document.parentWindow}}while(((new Date()).getTime()/1000)-aQ<aP&&J.doEvents());return undefined};this.getJSVariable=function(aP,aR){aR=w(aR,10);var aS=(new Date()).getTime()/1000,aQ=aO.getJSWindow(aR);if(aQ){while(undefined==aQ[aP]&&((new Date()).getTime()/1000)-aS<aR&&J.doEvents()){}return aQ[aP]}return undefined};var aL=b,aI=function(){if(!aL){var aP=aO.getJSWindow();if(aP){aP.attachEvent("onload",function(){var aQ=aO.initFunction;if(aQ){aQ(aP)}});aP.attachEvent("onunload",function(){aL=b});aL=V}}},aK={DocumentComplete:aI,DownloadComplete:aI,NavigateComplete2:aI};switch(ab(aJ)){case n:aK.OnQuit=function(){aO.close()};break;case ag:aN=R("WindowHook",aO.HWND);aN.hookMessage(ap,function(aR,aS,aQ,aP){aO.close();return aN.CallOriginalWndProc(aR,aS,aQ,aP)});break}aH=s(aO.webBrowser,aK,b)};(function(){J.newWindow=function(aI,aM,aP,aK,aR,aL,aJ,aO,aQ,aH){var aN;aK=w(aK,300);aR=w(aR,180);aM=w(aM,(al.availWidth-aK)>>1);aP=w(aP,(al.availHeight-aR)>>1);if(aH){aN=new k(c(aI));X(aN.HWND,aM,aP,aK,aR,1)}else{if(!aL){aL=J.WS_NORMAL}if(!aJ){aJ=0}aN=new k(v(aL,aM,aP,aK,aR,aJ,aI,0))}if(aO){aN.initFunction=aO}if(!aQ){af.attachEvent("onunload",function(){aN.close()})}return aN}})();(function(){J.msgBox=function(aI,aH){an(a,aI,document.title,aH?j:F)};af.alert=function(aH){J.msgBox(aH,V)};J.confirm=function(aK,aJ,aI){var aH=an(a,aK,document.title,(aI?ah:ac)|(aJ?0:ad));return aI?(aH==U):(aH==Y)};af.confirm=function(aJ,aI,aH){return J.confirm(aJ,aI,aH)}})();(function(){J.showTitleBar=function(aH){z.SetWindowLong(a,r,aH?J.WS_NO_TITLE_BAR:J.WS_NORMAL);z.SetWindowPos(a,d,0,0,0,0,aq|K|S|u)};J.updateTitle=function(){g(a,aC,0,document.title)};J.bring2Top=function(){ar(a)};J.centerWindow=function(aH,aK){var aI=al.availWidth,aJ=al.availHeight;if(aH>aI){aH=aI}aK+=av.btmBarHeight;if(aK>aJ){aK=aJ}X(a,(aI-aH)/2,(aJ-aK)/2,aH,aK,1);ar(a)};J.getWindowRect=function(){var aH=az();Q(a,aH);return aH};J.moveWindow=function(aK,aJ,aI,aH){X(a,aK,aJ,aI,aH,1)};J.getWindowPlacement=function(){var aH=x();aD(a,aH);return aH};J.setWindowPlacement=function(aH){aj(a,aH)}})();(function(){J.exitCallback=null;var aH=function(){return J.exitCallback?J.exitCallback():V};var aJ=R("WindowHook",a);aJ.hookMessage(ao,function(aM,aN,aL,aK){return aH()?aJ.CallOriginalWndProc(aM,aN,aL,aK):0});var aI=s(Z,{WindowClosing:function(aL,aK){aK.returnValue=V;if(aH()){if(J.isIE){Z.Quit()}else{av.closeWindow()}}}});af.attachEvent("onunload",function(){aJ.unhook();aI.disconnect()})})();(function(){J.newWindowCallback=null;var aH=s(Z,{NewWindow3:function(aK,aN,aJ,aM,aL){var aI=J.newWindowCallback;if(aI&&aI(aK,aN,aJ,aM,aL)){return}var aO=screen;aK.returnValue=LOCALJS.UI.newWindow(aL,aO.availWidth/2-5,aO.availHeight/2-5,10,10,LOCALJS.UI.WS_NO_TITLE_BAR)}});af.attachEvent("onunload",function(){aH.disconnect()})})()})();(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var e=LOCALJS;e.WEB_SERVICE=e.WEB_SERVICE||{};var a=e.WEB_SERVICE,d=localJS,c=d.COM,b=c.createObject;a.callUrl=function(h,g,l,k,j,f){var i=b("Microsoft.XMLHTTP");i.onreadystatechange=function(){if(4==i.readyState){i.onreadystatechange=function(){};if(200==i.status){if(l&&l.ok){l.ok(i.responseText,i)}}else{if(l&&l.fail){l.fail(i.status,i)}}i=null}};i.open(h,g,true,j,f);i.send(k)}})();(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var a=LOCALJS;a.LINB=a.LINB||{};var c=a.LINB,b=LOCALJS.FILE;c.callTemplateFile=function(f,d){var e=b.readUrl(b.normalizeUrl("template/"+f));if(false===e){return e}if(d.clsName){e=e.replace(/\{clsName\}/g,d.clsName)}if(d.theme){e=e.replace(/\{theme\}/g,d.theme)}if(d.lang){e=e.replace(/\{lang\}/g,d.lang)}if(d.content){e=e.replace(/\{content\}/g,d.content)}return e};c.saveTemplateFile=function(i,d,h){try{var f=c.callTemplateFile(i,d);if(false===f){return f}b.writeFileUTF8(h,f)}catch(g){return false}return true};c.isLocal=function(){return b.isFileUrl(b.normalizeUrl())};c.getSingleTemplateUrl=function(d){return b.normalizeUrl("template/single"+((linb.debug&&!d)?"debug":"")+".html")}})();