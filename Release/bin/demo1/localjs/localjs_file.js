(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var t=LOCALJS;t.FILE=t.FILE||{};var B=false,E=window,b=t.FILE,D=localJS,x=D.hostWnd,f=D.COM,K=f.createObject,H,r=function(){if(!H){H=K("Shell.Application")}return H},l,v=function(){if(!l){l=K("WScript.Shell")}return l},p,d=function(){if(!p){p=K("Scripting.FileSystemObject")}return p},A=function(L){return L?true:B},m=K("DllCall"),z=m.add,F=m.newStruct,a=m.newBuffer;z("shell32.dll","HINSTANCE ShellExecute(HWND hwnd,LPCTSTR lpOperation,LPCTSTR lpFile,LPCTSTR lpParameters,LPCTSTR lpDirectory,INT nShowCmd);");z("Kernel32.dll","UINT WINAPI GetPrivateProfileInt(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in INT nDefault,__in LPCTSTR lpFileName);");z("Kernel32.dll","DWORD WINAPI GetPrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpDefault,__out LPTSTR lpReturnedString,__in DWORD nSize,__in LPCTSTR lpFileName);");z("Kernel32.dll","BOOL WINAPI WritePrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpString,__in LPCTSTR lpFileName);");z("kernel32.dll","DWORD WINAPI GetModuleFileName(__in_opt HMODULE hModule,__out LPTSTR lpFilename,__in DWORD nSize);");z("comdlg32.dll","BOOL WINAPI GetOpenFileName(__inout LPOPENFILENAME lpofn);");z("comdlg32.dll","BOOL WINAPI GetSaveFileName(__inout LPOPENFILENAME lpofn);");z("shlwapi.dll","HRESULT UrlCombine(LPCTSTR pszBase,LPCTSTR pszRelative,LPTSTR pszCombined,LPDWORD pcchCombined,DWORD dwFlags);");z("urlmon.dll","STDAPI CoInternetParseUrl(LPCWSTR pwzUrl,PARSEACTION ParseAction,DWORD dwFlags,LPWSTR pszResult,DWORD cchResult,DWORD *pcchResult,DWORD dwReserved);","parseUrl");z("shlwapi.dll","BOOL UrlIs(LPCTSTR pszUrl,URLIS UrlIs);");z("shlwapi.dll","BOOL PathIsURL(LPCTSTR pszPath);");z("shlwapi.dll","HRESULT UrlCreateFromPath(LPCTSTR pszPath,LPTSTR pszUrl,LPDWORD pcchUrl,DWORD dwReserved);");var o=m.ShellExecute,C=m.GetPrivateProfileInt,j=m.GetPrivateProfileString,J=m.WritePrivateProfileString,q=m.GetModuleFileName,k=m.GetOpenFileName,s=m.GetSaveFileName,c=m.UrlCombine,w=m.parseUrl,h=m.UrlIs,e=m.PathIsURL,n=m.UrlCreateFromPath,y=9,i=4200,G=3,g=5,I=4096,u=536870912;(function(){b.iniWrite=function(L,P,M,N){try{N=N.toString()}catch(O){N=0}J(P,M,N,L)};b.iniReadInt=function(M,O,N,L){if(!L){L=0}return C(O,N,L,M)};b.iniReadStr=function(M,P,N,L){try{L=L.toString()}catch(O){L=""}var Q=a(4096);if(j(P,N,L,Q,Q.size>>1,M)){return Q.asStringW}return L};b.regWrite=function(L,N,M){v().RegWrite(L,N,M)};b.regRead=function(L){return v().RegRead(L)};b.regDelete=function(L){v().RegDelete(L)};b.fileExists=function(L){return A(d().FileExists(L))};b.folderExists=function(L){return A(d().FolderExists(L))};b.getAppDataFolder=function(M){var L=r().Namespace(26).Self.Path;return M?d().BuildPath(L,M):L};b.getProgramFolder=function(M){var L=r().Namespace(38).Self.Path;return M?d().BuildPath(L,M):L};b.getExeFilename=function(){var L=a(1024);q(0,L,L.size>>1);return L.asStringW};b.getExeFolder=function(){return d().GetParentFolderName(b.getExeFilename())};b.buildPath=function(L,M){return d().BuildPath(L,M)};b.getParentFolder=function(L){return d().GetParentFolderName(L)};b.readFileUTF8=function(M){try{var O=K("ADODB.Stream");O.Open();O.Charset="utf-8";O.LoadFromFile(M);var L=O.ReadText();O.Close();return L}catch(N){return B}};b.writeFileUTF8=function(L,N){var M=K("ADODB.Stream");adSaveCreateOverWrite=2;M.Open();M.Charset="utf-8";M.WriteText(N);M.SaveToFile(L,adSaveCreateOverWrite);M.Close()};b.deleteFile=function(L,M){d().DeleteFile(L,M)};b.createFolder=function(L){if(!d().FolderExists(L)){d().CreateFolder(L)}};b.deleteFolder=function(L,M){d().DeleteFolder(L,M)};b.listFolder=function(N){var L=[];if(d().FolderExists(N)){var O=p.GetFolder(N),M=K("Enumerator",O.Files);for(;!M.atEnd();M.moveNext()){L.push(M.item())}}return L};b.browseFile=function(O,Q,M,R,P,N,T){var S=function(){var U=33554432,X=4096,V=2048,Y=1,W=F().addLong("lStructSize").addLong(x).addLong("hInstance").add(a(512).address,"lpstrFilter").addLong("lpstrCustomFilter").addLong("nMaxCustFilter").addLong(1,"nFilterIndex").add(a(512).address,"lpstrFile").addLong("nMaxFile").addLong("lpstrFileTitle").addLong("nMaxFileTitle").add(a(512).address,"lpstrInitialDir").add(a(512).address,"lpstrTitle").addLong(U|X|V|(T?Y:0),"Flags").addShort("nFileOffset").addShort("nFileExtension").add(a(128).address,"lpstrDefExt").add(a(24));W.lStructSize=W.size;return W},L=S();if(M){L.lpstrFilter=M}if(Q){L.lpstrInitialDir=Q}if(R){L.lpstrTitle=R}else{L.lpstrTitle=document.title}if(P){L.lpstrDefExt=P}if(N){L.lpstrFile=N}L.nMaxFile=L.lpstrFile.size>>1;if(O?s(L):k(L)){return L.lpstrFile.asStringW}return B};b.browseFolder=function(O,L){try{var N=r().BrowseForFolder(x,O?O:document.title,0,L).Self.Path;return d().FolderExists(N)?N:""}catch(M){return B}};b.exec=function(L){o(0,0,L,0,0,1)};b.pathToUrl=function(N){var L=a(i),M=a(4,L.size>>1);if(n(N,L,M,0)>=0){return L.asStringW}return B};b.urlToPath=function(M){var N=a(512),L=a(4);if(w(M,y,0,N,N.size>>1,L,0)>=0){return N.asStringW}return B};b.isUrl=function(L){return A(e(L))};b.isFileUrl=function(L){return A(h(L,G))};b.readUrl=function(M,T){if(h(M,G)){var U=b.urlToPath(M),O=B;if(B!==U&&b.fileExists(U)){O=b.readFileUTF8(U)}if(!T){return O}if(B===O){if(T.fail){T.fail(O)}}else{if(T.ok){T.ok(O)}}}else{var Q=LOCALJS.WEB_SERVICE;if(T){Q.callUrl("GET",M,T)}else{var P,S=B,N=function(V){P=1;S=V},L=function(){P=-1};for(var R=0;R<5;++R){P=0;Q.callUrl("GET",M,{ok:N,fail:L});while(0==P){if(!LOCALJS.UI.doEvents()){return B}}if(1==P){break}}return S}}};b.buildUrl=function(N,L){var M=a(i),O=a(4,M.size>>1);if(c(N,L,M,O,I|u)>=0){return M.asStringW}return B};b.normalizeUrl=function(L){var M=document.URL.replace(/[#\?].*$/,"");if(!L){return M}return b.buildUrl(M,L)}})()})();