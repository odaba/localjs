(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var j=LOCALJS;if("undefined"!=typeof(j.FILE)){return}j.FILE={};var f=window,g=j.FILE,o=localJS,c=o.hostWnd,h=o.COM,x=h.createObject,D,q=function(){if(!D){D=x("Shell.Application")}return D},w,k=function(){if(!w){w=x("WScript.Shell")}return w},e,n=function(){if(!e){e=x("Scripting.FileSystemObject")}return e};dllCall=x("DllCall"),addFunc=dllCall.add,newStruct=dllCall.newStruct,newBuffer=dllCall.newBuffer;addFunc("shell32.dll","HINSTANCE ShellExecute(HWND hwnd,LPCTSTR lpOperation,LPCTSTR lpFile,LPCTSTR lpParameters,LPCTSTR lpDirectory,INT nShowCmd);");addFunc("Kernel32.dll","UINT WINAPI GetPrivateProfileInt(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in INT nDefault,__in LPCTSTR lpFileName);");addFunc("Kernel32.dll","DWORD WINAPI GetPrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpDefault,__out LPTSTR lpReturnedString,__in DWORD nSize,__in LPCTSTR lpFileName);");addFunc("Kernel32.dll","BOOL WINAPI WritePrivateProfileString(__in LPCTSTR lpAppName,__in LPCTSTR lpKeyName,__in LPCTSTR lpString,__in LPCTSTR lpFileName);");addFunc("kernel32.dll","DWORD WINAPI GetModuleFileName(__in_opt HMODULE hModule,__out LPTSTR lpFilename,__in DWORD nSize);");addFunc("comdlg32.dll","BOOL WINAPI GetOpenFileName(__inout LPOPENFILENAME lpofn);");addFunc("shlwapi.dll","HRESULT UrlCombine(LPCTSTR pszBase,LPCTSTR pszRelative,LPTSTR pszCombined,LPDWORD pcchCombined,DWORD dwFlags);");addFunc("urlmon.dll","STDAPI CoInternetParseUrl(LPCWSTR pwzUrl,PARSEACTION ParseAction,DWORD dwFlags,LPWSTR pszResult,DWORD cchResult,DWORD *pcchResult,DWORD dwReserved);","parseUrl");addFunc("shlwapi.dll","BOOL UrlIs(LPCTSTR pszUrl,URLIS UrlIs);");addFunc("shlwapi.dll","BOOL PathIsURL(LPCTSTR pszPath);");addFunc("shlwapi.dll","HRESULT UrlCreateFromPath(LPCTSTR pszPath,LPTSTR pszUrl,LPDWORD pcchUrl,DWORD dwReserved);");var C=dllCall.ShellExecute,m=dllCall.GetPrivateProfileInt,l=dllCall.GetPrivateProfileString,z=dllCall.WritePrivateProfileString,B=dllCall.GetModuleFileName,u=dllCall.GetOpenFileName,s=dllCall.UrlCombine,y=dllCall.parseUrl,i=dllCall.UrlIs,p=dllCall.PathIsURL,A=dllCall.UrlCreateFromPath,r=9,t=4200,d=3,a=5,b=4096,v=536870912;(function(){g.iniWrite=function(E,I,F,G){try{G=G.toString()}catch(H){G=0}z(I,F,G,E)};g.iniReadInt=function(F,H,G,E){if(!E){E=0}return m(H,G,E,F)};g.iniReadStr=function(F,I,G,E){try{E=E.toString()}catch(H){E=0}var J=newBuffer(4096);if(l(I,G,E,J,J.size>>1,F)){return J.asStringW}return""};g.regWrite=function(E,G,F){k().RegWrite(E,G,F)};g.regRead=function(E){return k().RegRead(E)};g.regDelete=function(E){return k().RegDelete(E)};g.fileExists=function(E){return n().FileExists(E)};g.folderExists=function(E){return n().FolderExists(E)};g.getAppDataFolder=function(F){var E=q().Namespace(26).Self.Path;return F?n().BuildPath(E,F):E};g.getProgramFolder=function(F){var E=q().Namespace(38).Self.Path;return F?n().BuildPath(E,F):E};g.getExeFilename=function(){var E=newBuffer(512);B(0,E,E.size>>1);return E.asStringW};g.getExeFolder=function(){return n().GetParentFolderName(g.getExeFilename())};g.buildPath=function(E,F){return n().BuildPath(E,F)};g.getParentFolder=function(E){return n().GetParentFolderName(E)};g.readFileUTF8=function(F){try{var H=x("ADODB.Stream");H.Open();H.Charset="utf-8";H.LoadFromFile(F);var E=H.ReadText();H.Close();return E}catch(G){return""}};g.writeFileUTF8=function(E,G){var F=x("ADODB.Stream");adSaveCreateOverWrite=2;F.Open();F.Charset="utf-8";F.WriteText(G);F.SaveToFile(E,adSaveCreateOverWrite);F.Close()};g.deleteFile=function(E,F){if(n().FileExists(E)){n().DeleteFile(E,F)}};g.createFolder=function(E){if(!n().FolderExists(E)){n().CreateFolder(E)}};g.deleteFolder=function(F,E){if(n().FolderExists(F)){n().DeleteFolder(F,E)}};g.listFolder=function(G){var E=[];if(n().FolderExists(G)){var H=e.GetFolder(G),F=x("Enumerator",H.Files);for(;!F.atEnd();F.moveNext()){E.push(F.item())}}return E};g.browseFile=function(E,H,K,G,J,L){var I=function(){var M=33554432,P=4096,N=2048,Q=1,O=newStruct().addLong("lStructSize").addLong(c).addLong("hInstance").add(newBuffer(512).address,"lpstrFilter").addLong("lpstrCustomFilter").addLong("nMaxCustFilter").addLong(1,"nFilterIndex").add(newBuffer(512).address,"lpstrFile").addLong("nMaxFile").addLong("lpstrFileTitle").addLong("nMaxFileTitle").add(newBuffer(512).address,"lpstrInitialDir").add(newBuffer(512).address,"lpstrTitle").addLong(M|P|N|(L?Q:0),"Flags").addShort("nFileOffset").addShort("nFileExtension").add(newBuffer(128).address,"lpstrDefExt").add(newBuffer(24));O.lStructSize=O.size;return O},F=I();if(H){F.lpstrFilter=H}if(E){F.lpstrInitialDir=E}if(K){F.lpstrTitle=K}if(G){F.lpstrDefExt=G}if(J){F.lpstrFile=J}F.nMaxFile=F.lpstrFile.size>>1;if(u(F)){return F.lpstrFile.asStringW}return false};g.browseFolder=function(F,E){return q().BrowseForFolder(c,F?F:document.title,0,E)};g.exec=function(E){C(0,0,E,0,0,1)};g.pathToUrl=function(G){var E=newBuffer(t),F=newBuffer(4,E.size>>1);if(A(G,E,F,0)>=0){return E.asStringW}return G};g.urlToPath=function(F){var G=newBuffer(512),E=newBuffer(4);if(y(F,r,0,G,G.size>>1,E,0)>=0){return G.asStringW}return F};g.isUrl=function(E){return p(E)};g.isFileUrl=function(E){return i(E,d)};g.isFolderUrl=function(E){return i(E,a)};g.readUrl=function(G){if(i(G,d)){var J=g.urlToPath(G);if(g.fileExists(J)){return g.readFileUTF8(J)}}else{var E,I,F=function(L){E=1;I=L},K=function(){E=-1};for(var H=0;H<5;++H){E=0;LOCALJS.WEB_SERVICE.callUrl("GET",G,{ok:F,fail:K});while(0==E){if(!LOCALJS.UI.doEvents()){return""}}if(1==E){return I}}}return""};g.buildUrl=function(F,H){var E=newBuffer(t),G=newBuffer(4,E.size>>1);if(s(F,H,E,G,b|v)>=0){return E.asStringW}return F};g.normalizeUrl=function(E){var F=document.URL.replace(/#.*$/,"");if(!E){return F}return g.buildUrl(F,E)}})()})();