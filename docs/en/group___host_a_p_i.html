<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<META NAME=KEYWORDS CONTENT="LocalJS Documentation JavaScript Trusted browser local access HTML CSS WPF COM .Net Windows API">
<META NAME=DESCRIPTION CONTENT="LocalJS Documentation, JavaScript in Trusted Browser. Fast, Easy and Low Cost. Develop Desktop Application with HTML/CSS/JavaScript, deployed and upgraded from web">
<title>LocalJS: LocalJS Hosting API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<div class="site_header"><a href="/">LocalJS Site</a> | <a href="/docs/">Documentation Home</a> | <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">Downloads</a> | <a href="http://sourceforge.net/tracker/?group_id=359375" target="_blank">Report an Issue</a></div>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="pages.html"><span>Getting&nbsp;Started</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
          <span class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </span><span class="right"></span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>LocalJS Hosting API</h1>  </div>
</div>
<div class="contents">

<p>C functions to launch and manage LocalJS browsers, also available to JavaScript. Typically, you can simply use the bootstrap program come with <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">demo application</a> on site.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="member-group"></a>
LocalJS initialization</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp7ff900691d65ed08d2a584a8680f27e1"></a> Initialize and uninitialize LocalJS </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BOOL __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga2bda3d0035edca22e5fd7d3cbca3fa03">initializeLocalJS</a> (HINSTANCE hInst, HICON hIcon, HICON hIconSm)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize LocalJS. <em>DO NOT call from <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a>.</em>  <a href="#ga2bda3d0035edca22e5fd7d3cbca3fa03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BOOL __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#gac45d62dc3eb89dfd8715187967f9ccd5">uninitializeLocalJS</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uninitialize LocalJS, free resources taken. <em>DO NOT call from <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a>.</em>  <a href="#gac45d62dc3eb89dfd8715187967f9ccd5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga7474b7f77001b41241fdadc926054645">setBrowserControlRegPath</a> (LPCSTR reg_path)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the default registry used by LocalJS browser to save its own options.  <a href="#ga7474b7f77001b41241fdadc926054645"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Launch LocalJS browser</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp6ce3b46880817d43230e86a98d8fce28"></a> All these functions can be called from JavaScript through <a class="el" href="interface_dll_call.html#ab6730ea57a7678c1f07953ce331edca0" title="Add function exported by DLL or EXE file as a method of current DllCall object.">DllCall.add</a>, to make it simple to launch new LocalJS browser or close them from JavaScript </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *__stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64">createBrowser</a> (DWORD dwStyle, int x, int y, int nWidth, int nHeight, HWND hWndParent, LPCWSTR url, LPCWSTR url_pattern, VARIANT *const pVarResult)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Launch a LocalJS browser.  <a href="#ga3bdfa56d0d14d6d6d5af554f7cc0be64"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *__stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2">createIE</a> (LPCWSTR url, LPCWSTR url_pattern)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Launch a LocalJS standalone Internet Explorer application.  <a href="#gac32ee10aa76ef792c4fad3f9cd6ce4f2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6">deleteBrowser</a> (void *browser)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free the browser handle retuned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a>.  <a href="#ga4942e4fc504290b5af5fe429b607b0c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#gabb3e24a4f8de3c63d4d835fac41ffa9e">detachBrowser</a> (void *browser)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Detach the browser handle from the underlying LocalJS browser or Internet Explorer application.  <a href="#gabb3e24a4f8de3c63d4d835fac41ffa9e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BOOL __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#gaf4383b8a7a504809b0cee77f832bd27e">translateBrowserAccelerator</a> (LPMSG lpmsg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used in message loop of LocalJS bootstrap program, to make sure shortcut keys like Tab, Ctrl-C work on HTML page controls.  <a href="#gaf4383b8a7a504809b0cee77f832bd27e"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Get information of running browser</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp5331a66a7f8be57d6fb2c1e148498784"></a> All these functions can be called from JavaScript through <a class="el" href="interface_dll_call.html#ab6730ea57a7678c1f07953ce331edca0" title="Add function exported by DLL or EXE file as a method of current DllCall object.">DllCall.add</a>, to make it simple to manage LocalJS browser from JavaScript </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BOOL __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga7978c69843099f89729ac84613ce6f78">browserRunning</a> (void *browser)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return underlying LocalJS browser or Internet Explorer running status.  <a href="#ga7978c69843099f89729ac84613ce6f78"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HWND __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf">getBrowserHostWnd</a> (void *browser)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the handle to window of LocalJS browser or Internet Explorer application.  <a href="#gaf00c5b78124ebf142708f1a02665c3bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HWND __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga0c446918df21860233f6543b19740ea0">getIETabWnd</a> (void *ie)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the <code>HWND</code> handle of current browser window tab. <em>ONLY</em> apply to Internet Explorer 7 and above.  <a href="#ga0c446918df21860233f6543b19740ea0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int __stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#gaca9b18f55c1ff51eb27b0c4ae8514f36">getBrowserType</a> (void *browser)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns underlying LocalJS browser type. 1 for LocalJS browser, 2 for LocalJS standalone Internet Explorer application.  <a href="#gaca9b18f55c1ff51eb27b0c4ae8514f36"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">IDispatch *__stdcall&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0">getBrowserObj</a> (void *browser)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.  <a href="#ga3d893359694af5cddd626024b2a1dfd0"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Call JavaScript functions</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp05389c451d8d3b5f4f2fd2d8b4e57fcf"></a> Call JavaScript function by C style function prototype </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void __cdecl&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388">callJSFunction</a> (void *browser, const bool popup_error, VARIANT *pvarResult, LPCSTR prototype,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Call JavaScript function by C style function prototype, passing variable number of arguments.  <a href="#ga22571896f2413830874c564bb4af8388"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void __cdecl&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___host_a_p_i.html#ga07b808427aa1778e265d83ea37f1a68b">callJSFunction_va_list</a> (void *browser, const bool popup_error, VARIANT *pvarResult, LPCSTR prototype, va_list vargs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Call JavaScript function by C style function prototype, passing variable number of arguments in one <code>va_list</code> argument.  <a href="#ga07b808427aa1778e265d83ea37f1a68b"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>C functions to launch and manage LocalJS browsers, also available to JavaScript. Typically, you can simply use the bootstrap program come with <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">demo application</a> on site. </p>
<p>Except functions <a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a> and <a class="el" href="group___host_a_p_i.html#ga07b808427aa1778e265d83ea37f1a68b" title="Call JavaScript function by C style function prototype, passing variable number of arguments in one v...">callJSFunction_va_list()</a> (which support variable number of arguments), all other functions are available to JavaScript through <a class="el" href="interface_dll_call.html" title="DllCall object enables JavaScript call functions exported by DLL or EXE files, including most Windows...">DllCall</a> object. Typically, LocalJS bootstrap program only uses these functions to create the first LocalJS browser window, everything else can be left to JavaScript.</p>
<p>Diagram below briefy shows typical workflow of LocalJS application:</p>
<div align="center">
<img src="overview.gif" alt="overview.gif"/>
<p><strong>LocalJS Workflow Overview</strong></p></div>
<p> Pseudo code illustrating the workflow above:</p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group___host_a_p_i.html#ga2bda3d0035edca22e5fd7d3cbca3fa03" title="Initialize LocalJS. DO NOT call from DllMain.">initializeLocalJS</a>();

    <span class="comment">// create main browser window:</span>
    <span class="keywordtype">void</span> * main_browser = <a class="code" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser</a>();
    <span class="comment">// Code flow transferred to JavaScript</span>

    <span class="comment">// JavaScript can call createBrowser() to create more browser windows</span>
    <span class="comment">// ...</span>
    <span class="comment">// Before main browser window exits, JavaScript calls deleteBrowser() to free browser window created by JavaScript</span>

    <span class="comment">// Code flow transferred back to bootstrap program</span>
    <a class="code" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser</a>(main_browser);

    <a class="code" href="group___host_a_p_i.html#gac45d62dc3eb89dfd8715187967f9ccd5" title="Uninitialize LocalJS, free resources taken. DO NOT call from DllMain.">uninitializeLocalJS</a>();
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>A typical LocalJS bootstrap program is provided along with source along with <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">demo application</a> on site. </dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga2bda3d0035edca22e5fd7d3cbca3fa03"></a><!-- doxytag: member="LocalJSHostAPI::initializeLocalJS" ref="ga2bda3d0035edca22e5fd7d3cbca3fa03" args="(HINSTANCE hInst, HICON hIcon, HICON hIconSm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL __stdcall initializeLocalJS </td>
          <td>(</td>
          <td class="paramtype">HINSTANCE&nbsp;</td>
          <td class="paramname"> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HICON&nbsp;</td>
          <td class="paramname"> <em>hIcon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HICON&nbsp;</td>
          <td class="paramname"> <em>hIconSm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize LocalJS. <em>DO NOT call from <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a>.</em> </p>
<p>Function <a class="el" href="group___host_a_p_i.html#ga2bda3d0035edca22e5fd7d3cbca3fa03" title="Initialize LocalJS. DO NOT call from DllMain.">initializeLocalJS()</a> should be called <em>before</em> any other LocalJS functions get called.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hInst</em>&nbsp;</td><td>A handle to the current instance of the application. Typically it's the <code>HINSTANCE</code> <code>hInstance</code> parameter passed to <a href="http://msdn.microsoft.com/en-us/library/ms633559(VS.85).aspx" target="_blank">WinMain Function</a>. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hIcon</em>&nbsp;</td><td>Handle to the icon for browser window. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hIconSm</em>&nbsp;</td><td>Handle to the small icon for browser window. Can be same as <em>hIcon</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE for successfully initialized, FALSE otherwise.</dd></dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd><em>DO NOT call <a class="el" href="group___host_a_p_i.html#ga2bda3d0035edca22e5fd7d3cbca3fa03" title="Initialize LocalJS. DO NOT call from DllMain.">initializeLocalJS()</a> from <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a>.</em> Function <a class="el" href="group___host_a_p_i.html#ga2bda3d0035edca22e5fd7d3cbca3fa03" title="Initialize LocalJS. DO NOT call from DllMain.">initializeLocalJS()</a> calls <a href="http://msdn.microsoft.com/en-us/library/ms678543(VS.85).aspx" target="_blank">CoInitialize Function</a> and <a href="http://msdn.microsoft.com/en-us/library/ms686615(VS.85).aspx" target="_blank">CoCreateInstance Function</a>, which should not be called in <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a> according to MSDN.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#gac45d62dc3eb89dfd8715187967f9ccd5" title="Uninitialize LocalJS, free resources taken. DO NOT call from DllMain.">uninitializeLocalJS()</a> | <a href="http://msdn.microsoft.com/en-us/library/ms633559(VS.85).aspx" target="_blank">WinMain Function</a> | <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain Callback Function</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gac45d62dc3eb89dfd8715187967f9ccd5"></a><!-- doxytag: member="LocalJSHostAPI::uninitializeLocalJS" ref="gac45d62dc3eb89dfd8715187967f9ccd5" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL __stdcall uninitializeLocalJS </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uninitialize LocalJS, free resources taken. <em>DO NOT call from <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a>.</em> </p>
<p>Function <a class="el" href="group___host_a_p_i.html#gac45d62dc3eb89dfd8715187967f9ccd5" title="Uninitialize LocalJS, free resources taken. DO NOT call from DllMain.">uninitializeLocalJS()</a> should be called <em>after</em> any other LocalJS functions get called.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE for successfully uninitialized, FALSE otherwise.</dd></dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd><em>DO NOT call <a class="el" href="group___host_a_p_i.html#gac45d62dc3eb89dfd8715187967f9ccd5" title="Uninitialize LocalJS, free resources taken. DO NOT call from DllMain.">uninitializeLocalJS()</a> from <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a>.</em> Function <a class="el" href="group___host_a_p_i.html#ga2bda3d0035edca22e5fd7d3cbca3fa03" title="Initialize LocalJS. DO NOT call from DllMain.">initializeLocalJS()</a> calls <a href="http://msdn.microsoft.com/en-us/library/ms688715(VS.85).aspx" target="_blank">CoUninitialize Function</a>, which should not be called in <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain</a> according to MSDN.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga2bda3d0035edca22e5fd7d3cbca3fa03" title="Initialize LocalJS. DO NOT call from DllMain.">initializeLocalJS()</a> | <a href="http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx" target="_blank">DllMain Callback Function</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga7474b7f77001b41241fdadc926054645"></a><!-- doxytag: member="LocalJSHostAPI::setBrowserControlRegPath" ref="ga7474b7f77001b41241fdadc926054645" args="(LPCSTR reg_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __stdcall setBrowserControlRegPath </td>
          <td>(</td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>reg_path</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Change the default registry used by LocalJS browser to save its own options. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>reg_path</em>&nbsp;</td><td>The new registry path</td></tr>
  </table>
  </dd>
</dl>
<p>Calling this function is optional. You can ignore this function if you don't need to change it.</p>
<p>LocalJS browser (launched by function <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a>) will not load any plugin or BHO(Browser Helper Object) objects installed to system and loaded by standalone Internet Explorer application. It uses a different registry entry to save browser settings like home page, fonts, etc.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>LocalJS standalone Internet Explorer application (launched by function <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a>) doesn't use this registry entry and will load BHO objects and plugins as a normal Internet Explorer application does.</dd></dl>
<p>The default registry entry used by LocalJS browser is HKEY_CURRENT_USER\Software\LocalJS\WebBrowser. You can change the path by passing another path style string like:</p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group___host_a_p_i.html#ga7474b7f77001b41241fdadc926054645" title="Change the default registry used by LocalJS browser to save its own options.">setBrowserControlRegPath</a>(<span class="stringliteral">&quot;Software\\YourProduct\\YourName&quot;</span>);
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd><ul>
<li>The root path HKEY_CURRENT_USER cannot be changed. </li>
<li>The default registry entry will be created automatically by LocalJS. </li>
<li>If you changed the registry entry, please make sure the new entry exists in system registry. </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="ga3bdfa56d0d14d6d6d5af554f7cc0be64"></a><!-- doxytag: member="LocalJSHostAPI::createBrowser" ref="ga3bdfa56d0d14d6d6d5af554f7cc0be64" args="(DWORD dwStyle, int x, int y, int nWidth, int nHeight, HWND hWndParent, LPCWSTR url, LPCWSTR url_pattern, VARIANT *const pVarResult)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void *__stdcall createBrowser </td>
          <td>(</td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwStyle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nWidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HWND&nbsp;</td>
          <td class="paramname"> <em>hWndParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>url_pattern</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VARIANT *const &nbsp;</td>
          <td class="paramname"> <em>pVarResult</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Launch a LocalJS browser. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwStyle</em>&nbsp;</td><td>The window style of the browser window. Refer to <a href="http://msdn.microsoft.com/en-us/library/ms632600(VS.85).aspx" target="_blank">Window Styles</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>x</em>&nbsp;</td><td>The initial horizontal position of the window. Refer to parameter <em>x</em> of <a href="http://msdn.microsoft.com/en-us/library/ms632679(VS.85).aspx" target="_blank">CreateWindow Function</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>y</em>&nbsp;</td><td>The initial vertical position of the window. Refer to parameter <em>y</em> of <a href="http://msdn.microsoft.com/en-us/library/ms632679(VS.85).aspx" target="_blank">CreateWindow Function</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nWidth</em>&nbsp;</td><td>The width, in device units, of the window. Refer to parameter <em>nWidth</em> of <a href="http://msdn.microsoft.com/en-us/library/ms632679(VS.85).aspx" target="_blank">CreateWindow Function</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nHeight</em>&nbsp;</td><td>The height, in device units, of the window. Refer to parameter <em>nHeight</em> of <a href="http://msdn.microsoft.com/en-us/library/ms632679(VS.85).aspx" target="_blank">CreateWindow Function</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hWndParent</em>&nbsp;</td><td>A handle to the parent or owner window of the window being created. Refer to parameter <em>hWndParent</em> of <a href="http://msdn.microsoft.com/en-us/library/ms632679(VS.85).aspx" target="_blank">CreateWindow Function</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>url</em>&nbsp;</td><td>The initial url the browser navigates to. If <em>url</em> is NULL, the browser doesn't navigate to anywhere. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>url_pattern</em>&nbsp;</td><td>A <a href="http://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html" target="_blank">Perl Regular Expression</a> that will be matched against each url the browser navigates to. </p>
<ul>
<li>If it doesn't match, then <a class="el" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a> object will not be available in the page. </li>
<li>If <em>url_pattern</em> is NULL, then <a class="el" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a> object is available for any url. </li>
</ul>
</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pVarResult</em>&nbsp;</td><td>Receive the parameter <em>result</em> passed to JavaScript method <a class="el" href="interfacelocal_j_s.html#ae0a273e38f45d2547157ddb6cfa6108c" title="Close the current browser window. NOT available in standalone Internet Explorer application.">localJS.closeWindow</a>. Can be NULL to ignore the <em>result</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A handle to the LocalJS browser created. The handle <em>MUST</em> be passed to <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a> to be freed.</dd></dl>
<p>Code below launches a LocalJS browser:</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> * hLocalJSBrowser = <a class="code" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">LocalJS::createBrowser</a>(WS_POPUP | WS_VISIBLE, 100, 100, 300, 200, NULL, L<span class="stringliteral">&quot;http://www.localJS.org/&quot;</span>, NULL, NULL);
</pre></div><p><a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> can be called from JavaScript to create another LocalJS browser window:</p>
<div class="fragment"><pre class="fragment">    var dllCall = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&#39;DllCall&#39;</span>);
    dllCall.add(<span class="stringliteral">&quot;LocalJS.dll&quot;</span>, <span class="stringliteral">&quot;void * __stdcall createBrowser(DWORD dwStyle, int x, int y, int nWidth, int nHeight, HWND hWndParent, LPCWSTR url, LPCWSTR url_pattern, VARIANT * const pVarResult);&quot;</span>);

    var WS_POPUP = 0x80000000, <span class="comment">// Refer to window styles in MSDN</span>
        WS_VISIBLE = 0x10000000;

    var browser = dllCall.createBrowser(WS_POPUP | WS_VISIBLE, 100, 100, 300, 200, 0, <span class="stringliteral">&quot;http://www.localJS.org/&quot;</span>, 0, 0);
</pre></div><p>To get the WebBrowser object of the new LocalJS browser, call <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a>:</p>
<div class="fragment"><pre class="fragment">    dllCall.add(<span class="stringliteral">&quot;LocalJS.dll&quot;</span>, <span class="stringliteral">&quot;IDispatch * __stdcall getBrowserObj(void * browser);&quot;</span>);
    var browser_obj = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.interface2Object(dllCall.getBrowserObj(browser));

    <span class="comment">// To navigate the new LocalJS browser with WebBrowser object:</span>
    browser_obj.Navigate2(<span class="stringliteral">&quot;http://www.google.com/&quot;</span>);
</pre></div><p>To access the <a href="http://www.javascriptkit.com/jsref/window.shtml" target="_blank">JavaScript Window object</a> of the new LocalJS browser:</p>
<div class="fragment"><pre class="fragment">    var new_window = browser_obj.Document.parentWindow;
</pre></div><p>Next, to access <em>global</em> JavaScript functions and variables in the new LocalJS browser page:</p>
<div class="fragment"><pre class="fragment">    var new_window_func = new_window.function_name; <span class="comment">// assuming function_name is a global function name in the new page</span>
    var new_window_variable = new_window.variable_name; <span class="comment">// assuming variable_name is a global variable name in the new page</span>
</pre></div><p>Now JavaScript in the creating page has access to JavaScript functions and variables in the new created browser page, the two pages then can call each other back and forth as they co-exist in same page!</p>
<p>Finally, don't forget to delete the browser handle with <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a>:</p>
<div class="fragment"><pre class="fragment">    dllCall.add(<span class="stringliteral">&quot;LocalJS.dll&quot;</span>, <span class="stringliteral">&quot;void __stdcall deleteBrowser(void * browser)&quot;</span>);
    dllCall.deleteBrowser(browser);
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>It's not necessary to calculate the window position and window style in <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a>. Both position and window style can be changed in JavaScript by call Windows API functions <a href="http://msdn.microsoft.com/en-us/library/ms633534(VS.85).aspx" target="_blank">MoveWindow</a>, <a href="http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx" target="_blank">SetWindowPos</a> and <a href="http://msdn.microsoft.com/en-us/library/ms633591(VS.85).aspx" target="_blank">SetWindowLong</a>. Refer to <a class="el" href="interfacelocal_j_s.html#a3566d4b69cb659d2e22501a77bc5af32" title="ReadOnly. Returns the height of the bottom localJS bar in pixels.">localJS.btmBarHeight</a> for an example.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="interfacelocal_j_s.html#ae0a273e38f45d2547157ddb6cfa6108c" title="Close the current browser window. NOT available in standalone Internet Explorer application.">localJS.closeWindow</a> | <a class="el" href="interface_dll_call.html#ab6730ea57a7678c1f07953ce331edca0" title="Add function exported by DLL or EXE file as a method of current DllCall object.">DllCall.add</a> | <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> | <a class="el" href="interface_c_o_m.html#a9742cc74cdf0445008d4adb2adbaa0d3" title="Convert a raw IDispatch * pointer to an object usable in JavaScript.">COM.interface2Object</a> | <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a> | <a class="el" href="interfacelocal_j_s.html#a3566d4b69cb659d2e22501a77bc5af32" title="ReadOnly. Returns the height of the bottom localJS bar in pixels.">localJS.btmBarHeight</a> | <a href="http://www.javascriptkit.com/jsref/window.shtml" target="_blank">JavaScript Window object</a> | <a href="http://msdn.microsoft.com/en-us/library/ms632679(VS.85).aspx" target="_blank">CreateWindow</a> | <a href="http://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html" target="_blank">Perl Regular Expression</a> | <a href="http://msdn.microsoft.com/en-us/library/ms633534(VS.85).aspx" target="_blank">MoveWindow</a> | <a href="http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx" target="_blank">SetWindowPos</a> | <a href="http://msdn.microsoft.com/en-us/library/ms633591(VS.85).aspx" target="_blank">SetWindowLong</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gac32ee10aa76ef792c4fad3f9cd6ce4f2"></a><!-- doxytag: member="LocalJSHostAPI::createIE" ref="gac32ee10aa76ef792c4fad3f9cd6ce4f2" args="(LPCWSTR url, LPCWSTR url_pattern)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void *__stdcall createIE </td>
          <td>(</td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>url_pattern</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Launch a LocalJS standalone Internet Explorer application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>url</em>&nbsp;</td><td>The initial url Internet Explorer navigates to. If <em>url</em> is NULL, Internet Explorer goes to it's home page. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>url_pattern</em>&nbsp;</td><td>A <a href="http://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html" target="_blank">Perl Regular Expression</a> that will be matched against each url Internet Explorer navigates to. If it doesn't match, then <a class="el" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a> object will not be available in the page. If <em>url_pattern</em> is NULL, then <a class="el" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a> object is available for any url.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A handle to the Internet Explorer created. The handle <em>MUST</em> be passed to <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a> to be freed.</dd></dl>
<p>Code below launches a LocalJS standalone Internet Explorer:</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> * hLocalJSIE = <a class="code" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">LocalJS::createIE</a>(L<span class="stringliteral">&quot;http://www.localJS.org/&quot;</span>, NULL);
</pre></div><p><a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> can be called from JavaScript:</p>
<div class="fragment"><pre class="fragment">    var dllCall = <a class="code" href="interfacelocal_j_s.html" title="The root object for all LocalJS objects. Available directly in JavaScript.">localJS</a>.COM.createObject(<span class="stringliteral">&#39;DllCall&#39;</span>);
    dllCall(<span class="stringliteral">&quot;LocalJS.dll&quot;</span>, <span class="stringliteral">&quot;void * __stdcall createIE(LPCWSTR url, LPCWSTR url_pattern);&quot;</span>);
    var browser = dllCall.createIE(<span class="stringliteral">&quot;http://www.localJS.org/&quot;</span>, 0);
</pre></div><p>Although the position where the Internet Explorer application window initially appear cannot be specified, the window can be moved in JavaScript when HTML page is loaded:</p>
<div class="fragment"><pre class="fragment">    window.attachEvent(<span class="stringliteral">&quot;onload&quot;</span>, function()
    {
        dllCall.add(<span class="stringliteral">&quot;user32.dll&quot;</span>, <span class="stringliteral">&quot;BOOL MoveWindow(HWND hWnd,int X,int Y,int nWidth,int nHeight,BOOL bRepaint);&quot;</span>);
        dllCall.add(<span class="stringliteral">&quot;LocalJS.dll&quot;</span>, <span class="stringliteral">&quot;HWND __stdcall getBrowserHostWnd(void * browser);&quot;</span>);
        dllCall.MoveWindow(dllCall.getBrowserHostWnd(browser), 50, 50, 300, 200, 1);
    }
</pre></div><p>With the browser handle returned by createIE, all example code using the browser handle in section <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> work in the same way. Although the standalone Internet Explorer application is in a separated process from LocalJS browser, the JavaScript running in LocalJS Internet Explorer can still interop with JavaScript running in LocalJS browser.</p>
<p>The handle retuned by <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> <em>MUST</em> be freed by <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a>.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Since LocalJS standalone Internet Explorer application is in a separated process from LocalJS bootstrap program, following LocalJS properties and methods behave differently for LocalJS Internet Explorer application: <ul>
<li><a class="el" href="interfacelocal_j_s.html#a29a79e553fe87184f3a6ed6a9e0b270f" title="Get or set a boolean value to control whether pressing F5 key reloads HTML page. Ignored by standalon...">localJS.enableF5</a> cannot disable F5 key press for LocalJS Internet Explorer </li>
<li><a class="el" href="interfacelocal_j_s.html#ae0a273e38f45d2547157ddb6cfa6108c" title="Close the current browser window. NOT available in standalone Internet Explorer application.">localJS.closeWindow</a> is not available for LocalJS Internet Explorer </li>
<li><a class="el" href="interface_window_hook.html" title="Hook messages of the specified window.">WindowHook</a> object cannot hook window message of LocalJS Internet Explorer window</li>
</ul>
</dd>
<dd>
Some browsers replace system object "InternetExplorer.Application" with their own browser object. In this case, <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> will launch their browser.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="interface_dll_call.html#ab6730ea57a7678c1f07953ce331edca0" title="Add function exported by DLL or EXE file as a method of current DllCall object.">DllCall.add</a> | <a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf" title="Returns the handle to window of LocalJS browser or Internet Explorer application.">getBrowserHostWnd()</a> | <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> | <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a> | <a class="el" href="interfacelocal_j_s.html#a29a79e553fe87184f3a6ed6a9e0b270f" title="Get or set a boolean value to control whether pressing F5 key reloads HTML page. Ignored by standalon...">localJS.enableF5</a> | <a class="el" href="interfacelocal_j_s.html#ae0a273e38f45d2547157ddb6cfa6108c" title="Close the current browser window. NOT available in standalone Internet Explorer application.">localJS.closeWindow</a> | <a class="el" href="interface_window_hook.html" title="Hook messages of the specified window.">WindowHook</a> | <a href="http://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html" target="_blank">Perl Regular Expression</a> | <a href="http://msdn.microsoft.com/en-us/library/ms633534(VS.85).aspx" target="_blank">MoveWindow</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga4942e4fc504290b5af5fe429b607b0c6"></a><!-- doxytag: member="LocalJSHostAPI::deleteBrowser" ref="ga4942e4fc504290b5af5fe429b607b0c6" args="(void *browser)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __stdcall deleteBrowser </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free the browser handle retuned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a>. </p>
<p>Call this function will close the underlying LocalJS browser window or terminate LocalJS standalone Internet Explorer application, unless <a class="el" href="group___host_a_p_i.html#gabb3e24a4f8de3c63d4d835fac41ffa9e" title="Detach the browser handle from the underlying LocalJS browser or Internet Explorer application...">detachBrowser()</a> has been called on the browser handle.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>browser</em>&nbsp;</td><td>Browser handle to be freed, retuned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> | <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> | <a class="el" href="group___host_a_p_i.html#gabb3e24a4f8de3c63d4d835fac41ffa9e" title="Detach the browser handle from the underlying LocalJS browser or Internet Explorer application...">detachBrowser()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gabb3e24a4f8de3c63d4d835fac41ffa9e"></a><!-- doxytag: member="LocalJSHostAPI::detachBrowser" ref="gabb3e24a4f8de3c63d4d835fac41ffa9e" args="(void *browser)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __stdcall detachBrowser </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Detach the browser handle from the underlying LocalJS browser or Internet Explorer application. </p>
<p>After <a class="el" href="group___host_a_p_i.html#gabb3e24a4f8de3c63d4d835fac41ffa9e" title="Detach the browser handle from the underlying LocalJS browser or Internet Explorer application...">detachBrowser()</a> is called, call <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a> on the same browser handle won't close the LocalJS browser window nor terminate LocalJS standalone Internet Explorer application. Functions <a class="el" href="group___host_a_p_i.html#ga7978c69843099f89729ac84613ce6f78" title="Return underlying LocalJS browser or Internet Explorer running status.">browserRunning()</a>, <a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf" title="Returns the handle to window of LocalJS browser or Internet Explorer application.">getBrowserHostWnd()</a>, <a class="el" href="group___host_a_p_i.html#ga0c446918df21860233f6543b19740ea0" title="Returns the HWND handle of current browser window tab. ONLY apply to Internet Explorer 7 and above...">getIETabWnd()</a>, <a class="el" href="group___host_a_p_i.html#gaca9b18f55c1ff51eb27b0c4ae8514f36" title="Returns underlying LocalJS browser type. 1 for LocalJS browser, 2 for LocalJS standalone Internet Exp...">getBrowserType()</a> and <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> return 0 on the detached browser handle.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>browser</em>&nbsp;</td><td>Browser handle to be detached, retuned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a></td></tr>
  </table>
  </dd>
</dl>
<p>It's OK to call <a class="el" href="group___host_a_p_i.html#gabb3e24a4f8de3c63d4d835fac41ffa9e" title="Detach the browser handle from the underlying LocalJS browser or Internet Explorer application...">detachBrowser()</a> more than once on same browser handle.</p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>The browser handle passed to <a class="el" href="group___host_a_p_i.html#gabb3e24a4f8de3c63d4d835fac41ffa9e" title="Detach the browser handle from the underlying LocalJS browser or Internet Explorer application...">detachBrowser()</a> still need to be freed by <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a>.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> | <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> | <a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a> | <a class="el" href="group___host_a_p_i.html#ga7978c69843099f89729ac84613ce6f78" title="Return underlying LocalJS browser or Internet Explorer running status.">browserRunning()</a> | <a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf" title="Returns the handle to window of LocalJS browser or Internet Explorer application.">getBrowserHostWnd()</a> | <a class="el" href="group___host_a_p_i.html#ga0c446918df21860233f6543b19740ea0" title="Returns the HWND handle of current browser window tab. ONLY apply to Internet Explorer 7 and above...">getIETabWnd()</a> | <a class="el" href="group___host_a_p_i.html#gaca9b18f55c1ff51eb27b0c4ae8514f36" title="Returns underlying LocalJS browser type. 1 for LocalJS browser, 2 for LocalJS standalone Internet Exp...">getBrowserType()</a> | <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaf4383b8a7a504809b0cee77f832bd27e"></a><!-- doxytag: member="LocalJSHostAPI::translateBrowserAccelerator" ref="gaf4383b8a7a504809b0cee77f832bd27e" args="(LPMSG lpmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL __stdcall translateBrowserAccelerator </td>
          <td>(</td>
          <td class="paramtype">LPMSG&nbsp;</td>
          <td class="paramname"> <em>lpmsg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used in message loop of LocalJS bootstrap program, to make sure shortcut keys like Tab, Ctrl-C work on HTML page controls. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>lpmsg</em>&nbsp;</td><td>Pointer to a <a href="http://msdn.microsoft.com/en-us/library/ms644958(VS.85).aspx" target="_blank">MSG Structure</a> passed to <a href="http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx" target="_blank">GetMessage Function</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><code>TRUE</code> if the message has been translated to other messages, <code>FALSE</code> otherwise.</dd></dl>
<p>Sample message loop using <a class="el" href="group___host_a_p_i.html#gaf4383b8a7a504809b0cee77f832bd27e" title="Used in message loop of LocalJS bootstrap program, to make sure shortcut keys like Tab...">translateBrowserAccelerator()</a>:</p>
<div class="fragment"><pre class="fragment">    BOOL bRet;
    <span class="keywordflow">while</span>( (bRet = GetMessage(&amp;msg, hWnd, 0, 0 )) != 0)
    {
        <span class="keywordflow">if</span> (bRet == -1)
        {
            <span class="comment">// handle the error and possibly exit</span>
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">if</span> (!<a class="code" href="group___host_a_p_i.html#gaf4383b8a7a504809b0cee77f832bd27e" title="Used in message loop of LocalJS bootstrap program, to make sure shortcut keys like Tab...">LocalJS::translateBrowserAccelerator</a>(&amp;msg))
            {
                TranslateMessage(&amp;msg);
                DispatchMessage(&amp;msg);
            }
        }
    }
</pre></div><p>Refer to <a class="el" href="interface_thread.html#a2bb58b88ac256b165a95a806ae3b41e5" title="ReadOnly. Returns true if the thread is running, false if the thread has ended.">Thread.running</a> for an example using <a class="el" href="group___host_a_p_i.html#gaf4383b8a7a504809b0cee77f832bd27e" title="Used in message loop of LocalJS bootstrap program, to make sure shortcut keys like Tab...">translateBrowserAccelerator()</a> in JavaScript function <code>doEvents</code>.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="interface_thread.html#a2bb58b88ac256b165a95a806ae3b41e5" title="ReadOnly. Returns true if the thread is running, false if the thread has ended.">Thread.running</a> | <a href="http://msdn.microsoft.com/en-us/library/ms644958(VS.85).aspx" target="_blank">MSG Structure</a> | <a href="http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx" target="_blank">GetMessage Function</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga7978c69843099f89729ac84613ce6f78"></a><!-- doxytag: member="LocalJSHostAPI::browserRunning" ref="ga7978c69843099f89729ac84613ce6f78" args="(void *browser)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL __stdcall browserRunning </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return underlying LocalJS browser or Internet Explorer running status. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>browser</em>&nbsp;</td><td>handle returned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><code>TRUE</code> if the underlying LocalJS browser or Internet Explorer is still running, <code>FALSE</code> otherwise</dd></dl>
<p>Function <a class="el" href="group___host_a_p_i.html#ga7978c69843099f89729ac84613ce6f78" title="Return underlying LocalJS browser or Internet Explorer running status.">browserRunning()</a> can be used to reuse running browser window:</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">bool</span> function goto_url(LPCWSTR url)
    {
        <span class="keywordflow">if</span> (!<a class="code" href="group___host_a_p_i.html#ga7978c69843099f89729ac84613ce6f78" title="Return underlying LocalJS browser or Internet Explorer running status.">LocalJS::browserRunning</a>(browser))
        {
            <a class="code" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">LocalJS::deleteBrowser</a>(browser);
            browser = <a class="code" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">LocalJS::createBrowser</a>(WS_POPUP | WS_VISIBLE, 100, 100, 300, 200, NULL, url, NULL, NULL);
            <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
        <span class="keywordflow">else</span>
        {
            <span class="comment">// navigate existing browser to the url</span>
            IDispatch * pdisp_browser = <a class="code" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">LocalJS::getBrowserObj</a>(browser);
            <span class="keywordflow">if</span> (!pdisp_browser)
                <span class="keywordflow">return</span> <span class="keyword">false</span>;

            CComQIPtr&lt;IWebBrowser2&gt; pweb_browser(pdisp_browser);
            pdisp_browser-&gt;Release();

            <span class="keywordflow">if</span> (!pweb_browser)
                <span class="keywordflow">return</span> <span class="keyword">false</span>;

            CComVariant flags(0);
            CComVariant target(_T(<span class="stringliteral">&quot;_self&quot;</span>));
            CComVariant postData;
            CComVariant headers;
            <span class="keywordflow">return</span> SUCCEEDED(pweb_browser-&gt;Navigate(CComBSTR(url), &amp;flags, &amp;target, &amp;postData, &amp;headers));
        }
    }
</pre></div><dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga4942e4fc504290b5af5fe429b607b0c6" title="Free the browser handle retuned by createBrowser() or createIE().">deleteBrowser()</a> | <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> | <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> | <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaf00c5b78124ebf142708f1a02665c3bf"></a><!-- doxytag: member="LocalJSHostAPI::getBrowserHostWnd" ref="gaf00c5b78124ebf142708f1a02665c3bf" args="(void *browser)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HWND __stdcall getBrowserHostWnd </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the handle to window of LocalJS browser or Internet Explorer application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>browser</em>&nbsp;</td><td>handle returned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The <code>HWND</code> handle of current browser window. For Internet Explorer 7 and above, it's the main window of the Internet Explorer application, not the tab window of the page. Returns zero for detached browser handle.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd><a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf" title="Returns the handle to window of LocalJS browser or Internet Explorer application.">getBrowserHostWnd()</a> returns same value as <a class="el" href="interfacelocal_j_s.html#aa05066bf1c7f31ea898c0d2aed29eedb" title="ReadOnly. Returns the HWND handle of current browser window.">localJS.hostWnd</a>.</dd></dl>
<dl class="user"><dt><b></b></dt><dd>Some browsers replace system object "InternetExplorer.Application" with their own browser object. In this case, <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> will launch their browser and <a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf" title="Returns the handle to window of LocalJS browser or Internet Explorer application.">getBrowserHostWnd()</a> may return NULL.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> | <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> | <a class="el" href="interfacelocal_j_s.html#aa05066bf1c7f31ea898c0d2aed29eedb" title="ReadOnly. Returns the HWND handle of current browser window.">localJS.hostWnd</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga0c446918df21860233f6543b19740ea0"></a><!-- doxytag: member="LocalJSHostAPI::getIETabWnd" ref="ga0c446918df21860233f6543b19740ea0" args="(void *ie)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HWND __stdcall getIETabWnd </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ie</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the <code>HWND</code> handle of current browser window tab. <em>ONLY</em> apply to Internet Explorer 7 and above. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ie</em>&nbsp;</td><td>handle returned by <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The <code>HWND</code> handle of current browser window tab. Returns zero for detached browser handle. <em>ONLY</em> apply to Internet Explorer 7 and above.</dd></dl>
<p>Compared to <a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf" title="Returns the handle to window of LocalJS browser or Internet Explorer application.">getBrowserHostWnd()</a>, which returns <code>HWND</code> to the main window of the Internet Explorer application, <a class="el" href="group___host_a_p_i.html#ga0c446918df21860233f6543b19740ea0" title="Returns the HWND handle of current browser window tab. ONLY apply to Internet Explorer 7 and above...">getIETabWnd()</a> returns <code>HWND</code> to the tab window of the page.</p>
<dl class="note"><dt><b>Note:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga0c446918df21860233f6543b19740ea0" title="Returns the HWND handle of current browser window tab. ONLY apply to Internet Explorer 7 and above...">getIETabWnd()</a> returns same value as <a class="el" href="interfacelocal_j_s.html#a231aa00f34826cb7baf3d21ca25cc2cc" title="ReadOnly. Returns the HWND handle of current browser window tab. ONLY apply to Internet Explorer 7 an...">localJS.IETabWnd</a>.</dd></dl>
<dl class="user"><dt><b></b></dt><dd>Some browsers replace system object "InternetExplorer.Application" with their own browser object. In this case, <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> will launch their browser and <a class="el" href="group___host_a_p_i.html#ga0c446918df21860233f6543b19740ea0" title="Returns the HWND handle of current browser window tab. ONLY apply to Internet Explorer 7 and above...">getIETabWnd()</a> may return NULL.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a> | <a class="el" href="group___host_a_p_i.html#gaf00c5b78124ebf142708f1a02665c3bf" title="Returns the handle to window of LocalJS browser or Internet Explorer application.">getBrowserHostWnd()</a> | <a class="el" href="interfacelocal_j_s.html#a231aa00f34826cb7baf3d21ca25cc2cc" title="ReadOnly. Returns the HWND handle of current browser window tab. ONLY apply to Internet Explorer 7 an...">localJS.IETabWnd</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaca9b18f55c1ff51eb27b0c4ae8514f36"></a><!-- doxytag: member="LocalJSHostAPI::getBrowserType" ref="gaca9b18f55c1ff51eb27b0c4ae8514f36" args="(void *browser)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __stdcall getBrowserType </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns underlying LocalJS browser type. 1 for LocalJS browser, 2 for LocalJS standalone Internet Explorer application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>browser</em>&nbsp;</td><td>handle returned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The underlying LocalJS browser type. <ul>
<li>1 for LocalJS browser </li>
<li>2 for LocalJS standalone Internet Explorer application </li>
<li>0 for detached browser handle </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="ga3d893359694af5cddd626024b2a1dfd0"></a><!-- doxytag: member="LocalJSHostAPI::getBrowserObj" ref="ga3d893359694af5cddd626024b2a1dfd0" args="(void *browser)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IDispatch *__stdcall getBrowserObj </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>browser</em>&nbsp;</td><td>handle returned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The WebBrowser object of underlying LocalJS browser or Internet Explorer. NULL for detached browser handle.</dd></dl>
<p>The return value of <a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> can be directly passed to <a class="el" href="interface_c_o_m.html#a9742cc74cdf0445008d4adb2adbaa0d3" title="Convert a raw IDispatch * pointer to an object usable in JavaScript.">COM.interface2Object</a> to make the WebBrowser object available in JavaScript. Refer to <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> for an example.</p>
<dl class="note"><dt><b>Note:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga3d893359694af5cddd626024b2a1dfd0" title="Returns the WebBrowser object of underlying LocalJS browser or Internet Explorer.">getBrowserObj()</a> calls <a href="http://msdn.microsoft.com/en-us/library/ms691379(VS.85).aspx" target="_blank">AddRef</a> on the returned IDispatch * pointer.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> | <a class="el" href="interface_c_o_m.html#a9742cc74cdf0445008d4adb2adbaa0d3" title="Convert a raw IDispatch * pointer to an object usable in JavaScript.">COM.interface2Object</a> | <a href="http://msdn.microsoft.com/en-us/library/ms691379(VS.85).aspx" target="_blank">AddRef</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga22571896f2413830874c564bb4af8388"></a><!-- doxytag: member="LocalJSHostAPI::callJSFunction" ref="ga22571896f2413830874c564bb4af8388" args="(void *browser, const bool popup_error, VARIANT *pvarResult, LPCSTR prototype,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __cdecl callJSFunction </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>popup_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VARIANT *&nbsp;</td>
          <td class="paramname"> <em>pvarResult</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>prototype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Call JavaScript function by C style function prototype, passing variable number of arguments. </p>
<p>Function <a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a> enables C++ code call JavaScript in specified browser window by C style function prototype, and get the return value of JavaScript function. Any errors in the process can be optionally popped up as message box, useful for debugging.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>browser</em>&nbsp;</td><td>Browser handle returned by <a class="el" href="group___host_a_p_i.html#ga3bdfa56d0d14d6d6d5af554f7cc0be64" title="Launch a LocalJS browser.">createBrowser()</a> or <a class="el" href="group___host_a_p_i.html#gac32ee10aa76ef792c4fad3f9cd6ce4f2" title="Launch a LocalJS standalone Internet Explorer application.">createIE()</a>. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>popup_error</em>&nbsp;</td><td>If <code>true</code>, any error will be popped up in message box; if <code>false</code>, no message pop up. Set it to true for debug. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pvarResult</em>&nbsp;</td><td>If not NULL, will receive the return result of JavaScript function. Can be set to NULL to ignore the return result. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>prototype</em>&nbsp;</td><td>C style function prototype string. See discussion below for detail. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>...</em>&nbsp;</td><td>Variable number of arguments, interpreted by parameter <em>prototype</em>. See discussion below for detail.</td></tr>
  </table>
  </dd>
</dl>
<h3>Example code</h3>
<p>Assuming we have JavaScript function defined as:</p>
<div class="fragment"><pre class="fragment">    <span class="comment">// funcCalledByCPP is a global variable</span>
    funcCalledByCPP = function(lval, str, obj)
    {
        lval.returnValue = 20;
        str.returnValue = <span class="stringliteral">&quot;String passed from Script&quot;</span>;
        obj.returnValue = function ()
        {
            <span class="keywordflow">return</span> str + <span class="stringliteral">&quot; &quot;</span> + lval;
        };

        <span class="keywordflow">return</span> 5;
    };
</pre></div><p>In C++ code, the JavaScript function <code>funcCalledByCPP</code> is called as below:</p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> * browser = lpPara; <span class="comment">// Assume lpPara is passed from calling function</span>

    <span class="comment">// Prepare variables</span>
    <span class="keywordtype">long</span> lval = 10;
    WCHAR wstr[256];
    wcscpy(wstr, L<span class="stringliteral">&quot;String passed from DLL&quot;</span>);
    IDispatch * pdisp = NULL;

    <span class="comment">// call JavaScript function</span>
    VARIANT vres;
    VariantInit(&amp;vres);
    <a class="code" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">LocalJS::callJSFunction</a>(browser, <span class="keyword">true</span>, &amp;vres, <span class="stringliteral">&quot;void funcCalledByCPP(long * plval, LPWSTR str, IDispatch ** obj)&quot;</span>, &amp;lval, wstr, &amp;pdisp);
</pre></div><p>After <a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a> returns, check the variables:</p>
<div class="fragment"><pre class="fragment">    <span class="comment">// display parameters changed by JavaScript function</span>
    WCHAR info[2048];
    swprintf(info, L<span class="stringliteral">&quot;The JS function returns %d\nThe value received from JS function is %d\nThe string received from JS function is:\n\t%s&quot;</span>, vres.lVal, lval, wstr);
    MessageBoxW(NULL, info, L<span class="stringliteral">&quot;TEST&quot;</span>, MB_SETFOREGROUND | MB_TOPMOST | MB_TASKMODAL | MB_ICONINFORMATION);

    VariantClear(&amp;vres);
</pre></div><p>The returned <code>IDispatch * pdisp</code> can be invoked too:</p>
<div class="fragment"><pre class="fragment">    <span class="keywordflow">if</span> (pdisp)
    {
        VARIANT vResult;
        VariantInit(&amp;vResult);

        DISPPARAMS disp_params = {NULL, NULL, 0, 0};
        pdisp-&gt;Invoke(DISPID_VALUE, IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_METHOD, &amp;disp_params, &amp;vResult, NULL, NULL);

        <span class="comment">// vResult now holds string &quot;String passed from Script 20&quot;</span>
        VariantClear(&amp;vResult);
    }
</pre></div><h3>Detail of function prototype</h3>
<p>Function prototype in <a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a> is a C style function prototype following rules below:</p>
<ul>
<li>
Declaration of function return type in prototype is ignored. </li>
<li>
Parameter names are optional. </li>
<li>
Parameter types can <em>ONLY</em> be chosen from table below: <br/>
 <br/>
 <table class="doxtable">
<tr>
<td><b>Type</b></td><td><b>Explaination</b> </td></tr>
<tr>
<td><code>LPSTR</code> </td><td>A ANSI / Multi-bytes string, can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>LPWSTR</code> </td><td>A wide / unicode string, can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>char</code> </td><td>A single signed byte </td></tr>
<tr>
<td><code>char *</code></td><td>pointer to a signed char variable whose value can be changed by JavaScript function using <code>para.returnValue</code>. <br/>
 <em>To pass ANSI string, use <code>LPSTR</em></code> </td></tr>
<tr>
<td><code>unsigned char</code></td><td>A single unsigned byte </td></tr>
<tr>
<td><code>unsigned char *</code></td><td>Pointer to a signed unsigned char variable whose value can be changed by JavaScript function using <code>para.returnValue</code>. <br/>
 <em>To pass ANSI string, use <code>LPSTR</em></code> </td></tr>
<tr>
<td><code>short</code> </td><td>A signed 2 bytes integer </td></tr>
<tr>
<td><code>short *</code></td><td>Pointer to a short variable whose value can be changed by JavaScript function using <code>para.returnValue</code>. <br/>
 <em>To pass wide/unicode string, use <code>LPWSTR</em></code> </td></tr>
<tr>
<td><code>unsigned short</code></td><td>An unsigned 2 bytes integer </td></tr>
<tr>
<td><code>unsigned short *</code></td><td>Pointer to an unsigned short variable whose value can be changed by JavaScript function using <code>para.returnValue</code>. <br/>
 <em>To pass wide/unicode string, use <code>LPWSTR</em></code> </td></tr>
<tr>
<td><code>long</code> </td><td>A signed 4 bytes integer </td></tr>
<tr>
<td><code>long *</code></td><td>Pointer to a long variable whose value can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>unsigned long</code></td><td>An unsigned 4 bytes integer </td></tr>
<tr>
<td><code>unsigned long *</code></td><td>Pointer to a unsigned long variable whose value can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>__int64</code> </td><td>A signed 8 bytes integer </td></tr>
<tr>
<td><code>__int64 *</code></td><td>Pointer to a __int64 variable whose value can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>unsigned <code>__int64</code></code> </td><td>An unsigned 8 bytes integer </td></tr>
<tr>
<td><code>unsigned <code>__int64</code> *</code></td><td>Pointer to an unsigned __int64 variable whose value can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>float</code> </td><td>A float variable </td></tr>
<tr>
<td><code>float *</code></td><td>Pointer to a float variable whose value can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>double</code> </td><td>A double variable </td></tr>
<tr>
<td><code>double *</code></td><td>Pointer to an double variable whose value can be changed by JavaScript function using <code>para.returnValue</code> </td></tr>
<tr>
<td><code>IDispatch *</code></td><td>An pointer of IDispatch * </td></tr>
<tr>
<td><code>IDispatch **</code></td><td>An pointer of IDispatch **, can be used to returned an IDispatch * by JavaScript function using <code>para.returnValue</code> </td></tr>
</table>
</li>
</ul>
<dl class="attention"><dt><b>Attention:</b></dt><dd><ul>
<li>
The number and type of parameters following parameter <em>prototype</em> <em>MUST</em> match the number and types described in parameter <em>prototype</em>. </li>
<li>
The JavaScript function name <em>MUST</em> be global, or the variable holding the function <em>MUST</em> be a global variable. </li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a> internally calls <a class="el" href="group___host_a_p_i.html#ga07b808427aa1778e265d83ea37f1a68b" title="Call JavaScript function by C style function prototype, passing variable number of arguments in one v...">callJSFunction_va_list()</a> for implementation:</dd></dl>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">void</span> __cdecl <a class="code" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction</a>(<span class="keywordtype">void</span> * browser, <span class="keyword">const</span> <span class="keywordtype">bool</span> popup_error, VARIANT * pvarResult, LPCSTR prototype, ...)
    {
        va_list args;
        va_start(args, prototype);
        <a class="code" href="group___host_a_p_i.html#ga07b808427aa1778e265d83ea37f1a68b" title="Call JavaScript function by C style function prototype, passing variable number of arguments in one v...">callJSFunction_va_list</a>(browser, popup_error, pvarResult, prototype, args);
        va_end(args);
        <span class="keywordflow">return</span>;
    }
</pre></div><dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga07b808427aa1778e265d83ea37f1a68b" title="Call JavaScript function by C style function prototype, passing variable number of arguments in one v...">callJSFunction_va_list()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga07b808427aa1778e265d83ea37f1a68b"></a><!-- doxytag: member="LocalJSHostAPI::callJSFunction_va_list" ref="ga07b808427aa1778e265d83ea37f1a68b" args="(void *browser, const bool popup_error, VARIANT *pvarResult, LPCSTR prototype, va_list vargs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __cdecl callJSFunction_va_list </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>browser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>popup_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VARIANT *&nbsp;</td>
          <td class="paramname"> <em>pvarResult</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>prototype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&nbsp;</td>
          <td class="paramname"> <em>vargs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Call JavaScript function by C style function prototype, passing variable number of arguments in one <code>va_list</code> argument. </p>
<p>Function <a class="el" href="group___host_a_p_i.html#ga07b808427aa1778e265d83ea37f1a68b" title="Call JavaScript function by C style function prototype, passing variable number of arguments in one v...">callJSFunction_va_list()</a> is the internal implementation of <a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a>. It's provided to be wrapped inside user functions accepting variable number arguments.</p>
<p>Refer to <a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a> for details.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group___host_a_p_i.html#ga22571896f2413830874c564bb4af8388" title="Call JavaScript function by C style function prototype, passing variable number of arguments...">callJSFunction()</a> </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><div class="footer"><a href="/">LocalJS Site</a> | <a href="/docs/">Documentation Home</a> | <a href="http://sourceforge.net/projects/localjs/files/" target="_blank">Downloads</a> | <a href="http://sourceforge.net/tracker/?group_id=359375" target="_blank">Report an Issue</a></div>
</body>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18928254-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</html>
