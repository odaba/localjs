(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var N=LOCALJS;if("undefined"!=typeof(N.UI)){return}N.UI={};var ad=window,I=N.UI,ar=localJS,a=ar.hostWnd,X=ar.webBrowser,A=ar.COM,Q=A.createObject,l=A.interface2Object,r=A.connectEvents,y=Q("DllCall"),s=y.add,p=y.newStruct,o=y.newBuffer,v=function(aF,aE){return"undefined"==typeof(aF)?aE:aF},aw=function(){return p().addLong("left").addLong("top").addLong("right").addLong("bottom")},aB=function(){return p().addLong("x").addLong("y")},w=function(){var aE=p().addLong("length").addLong("flags").addLong("showCmd").add(aB(),"ptMinPosition").add(aB(),"ptMaxPosition").add(aw(),"rcNormalPosition");aE.length=aE.size;return aE},C=function(){return p().addLong("hwnd").addLong("message").addLong("wParam").addLong("lParam").addLong("time").add(p().addLong("x").addLong("y"),"pt")};s("user32.dll","BOOL GetMessage(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax);");s("user32.dll","BOOL TranslateMessage(const MSG *lpMsg);");s("user32.dll","LRESULT DispatchMessage(const MSG *lpmsg);");s("user32.dll","void PostQuitMessage(int nExitCode);");s("LocalJS.dll","BOOL __stdcall translateBrowserAccelerator(LPMSG lpmsg);");s("user32.dll","LRESULT SendMessage(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam);");s("user32.dll","int WINAPI MessageBox(HWND hWnd,LPCTSTR lpText,LPCTSTR lpCaption,UINT uType);");s("user32.dll","LONG SetWindowLong(HWND hWnd, int nIndex, LONG dwNewLong);");s("user32.dll","BOOL SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags);");s("user32.dll","BOOL SetForegroundWindow(HWND hWnd);");s("user32.dll","BOOL MoveWindow(HWND hWnd,int X,int Y,int nWidth,int nHeight,BOOL bRepaint);");s("user32.dll","BOOL GetWindowRect(HWND hWnd,LPRECT lpRect);");s("user32.dll","BOOL GetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");s("user32.dll","BOOL SetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");s("LocalJS.dll","void * __stdcall createBrowserWindow(DWORD dwStyle, int x, int y, int nWidth, int nHeight, HWND hWndParent, LPCWSTR url, LPCWSTR url_pattern, VARIANT * const pVarResult);");s("LocalJS.dll","void __stdcall deleteBrowserWindow(void * browser)");s("LocalJS.dll","void __stdcall detachBrowserWindow(void * browser);");s("LocalJS.dll","IDispatch * __stdcall getBrowserObj(void * browser);");s("LocalJS.dll","BOOL __stdcall browserWindowClosed(void * browser);");s("LocalJS.dll","int __stdcall getBrowserType(void * browser);");s("LocalJS.dll","void * __stdcall createIE(LPCWSTR url, LPCWSTR url_pattern);");s("LocalJS.dll","HWND __stdcall getBrowserHostWnd(void * browser);");var d=y.GetMessage,z=y.TranslateMessage,K=y.DispatchMessage,h=y.PostQuitMessage,ap=y.translateBrowserAccelerator,f=y.SendMessage,ak=y.MessageBox,n=y.SetWindowLong,S=y.SetWindowPos,ao=y.SetForegroundWindow,V=y.MoveWindow,P=y.GetWindowRect,aA=y.GetWindowPlacement,ah=y.SetWindowPlacement,u=y.createBrowserWindow,k=y.deleteBrowserWindow,F=y.detachBrowserWindow,M=y.getBrowserObj,G=y.browserWindowClosed,L=y.getBrowserHostWnd,Z=y.getBrowserType,b=y.createIE,ae=1,m=2,q=-16,ai=0,at=2147483648,g=12582912,O=524288,H=131072,ay=65536,aq=268435456,D=262144,B=8388608,aC=ai|g|O|D|H|ay,an=32,J=64,R=2,t=1,c=0,al=16,az=12,am=2,U=16,ag=32,au=48,aD=64,e=65536,aj=8192,av=262144,ax=1,x=4,ab=256,Y=512,i=U|e|av|aj,E=aD|e|av|aj,aa=ag|e|av|aj|x,af=ag|e|av|aj|ax,T=1,W=6,ac=0;I.WS_CLOSE_ONLY=at|D|g|O|aq;I.WS_NO_TITLE_BAR=at|aq|O;I.WS_NORMAL=aC|aq;(function(){var aE=C();unloading=false;ad.attachEvent("onunload",function(){unloading=true});I.doEvents=function(){if(unloading){return false}var aF=d(aE,0,0,0);if(0==aF){h(aE.wParam);return false}if(aF>0){if(!ap(aE)){z(aE);K(aE)}}return true}})();(function(){var aF,aE=function(aG){return aG.getElementsByTagName("html")[0]};I.setDraggables=function(aG){aF=aG};I.addDraggable=function(aH){if(aH){if(!aF){aF=[];var aI=document,aG;if(aI){aF.push(aE(aI));aG=aI.body}if(aG){aF.push(aG)}}aF.push(aH)}};I.getDraggables=function(){return aF};ad.attachEvent("onload",function(){var aP=document,aM=aP.body,aK=aE(aP);if(!aF){aF=[aM,aK]}var aN=false,aG=aw(),aQ,aO,aH,aS,aJ=function(aT){if(aF&&aF.length){for(var aU=0;aU<aF.length;++aU){if(aF[aU]===aT){return true}}}return false},aL,aI="onlosecapture",aR=function(){aN=false;if(aL){aL.detachEvent(aI,aR);aL=null}};aP.attachEvent("onmousedown",function(){aL=event.srcElement;if(!aN&&(1&event.button)&&aJ(aL)&&event.clientX<aK.clientWidth&&event.clientY<aK.clientHeight){aN=true;aL.setCapture();aL.attachEvent(aI,aR);P(a,aG);aH=aG.right-aG.left;aS=aG.bottom-aG.top;aQ=event.screenX;aO=event.screenY}});aP.attachEvent("onmousemove",function(){if(aN){V(a,aG.left+event.screenX-aQ,aG.top+event.screenY-aO,aH,aS,1)}});aP.attachEvent("onmouseup",function(){if(aN&&aL){aL.releaseCapture()}})})})();var j=function(aJ){var aG=aJ,aL=this,aE,aK;this.webBrowser=l(M(aG));this.HWND=L(aG);this.initFunction=null;this.getHandle=function(){return aG};this.close=function(aN){if(aG){var aM=aG;aG=0;aL.webBrowser=null;aL.HWND=0;if(aK){aK.unhook()}if(aE){aE.disconnect()}if(aN){F(aM)}k(aM)}};this.isClosed=function(){return G(aG)?true:false};this.getJSWindow=function(){if(aL.webBrowser&&aL.webBrowser.Document){return aL.webBrowser.Document.parentWindow}return null};this.getJSVariable=function(aM){var aN=aL.getJSWindow();if(aN){return aN[aM]}return null};var aI=false,aF=function(){if(!aI){var aM=aL.getJSWindow();if(aM){aM.attachEvent("onload",function(){var aN=aL.initFunction;if(aN){aN(aM)}});aM.attachEvent("onunload",function(){aI=false});aI=true}}},aH={DocumentComplete:aF,DownloadComplete:aF,NavigateComplete2:aF};switch(Z(aG)){case m:aH.OnQuit=function(){aL.close()};break;case ae:aK=Q("WindowHook",aL.HWND);aK.hookMessage(am,function(aO,aP,aN,aM){aL.close();return aK.CallOriginalWndProc(aO,aP,aN,aM)});break}aE=r(aL.webBrowser,aH,false)};(function(){I.newWindow=function(aF,aJ,aN,aH,aP,aI,aG,aM,aO,aL,aE){var aK;aJ=v(aJ,100);aN=v(aN,100);aH=v(aH,300);aP=v(aP,180);aL=v(aL,0);if(aE){aK=new j(b(aF,aL));V(aK.HWND,aJ,aN,aH,aP,1)}else{if(!aI){aI=I.WS_NORMAL}if(!aG){aG=0}aK=new j(u(aI,aJ,aN,aH,aP,aG,aF,aL,0))}if(aM){aK.initFunction=aM}if(!aO){ad.attachEvent("onunload",function(){aK.close()})}return aK}})();(function(){I.msgBox=function(aF,aE){ak(a,aF,document.title,aE?i:E)};ad.alert=function(aE){I.msgBox(aE,true)};I.confirm=function(aH,aG,aF){var aE=ak(a,aH,document.title,(aF?af:aa)|(aG?0:ab));return aF?(aE==T):(aE==W)};ad.confirm=function(aE){return I.confirm(aE)}})();(function(){I.showTitleBar=function(aE){y.SetWindowLong(a,q,aE?I.WS_NO_TITLE_BAR:I.WS_NORMAL);y.SetWindowPos(a,c,0,0,0,0,an|J|R|t)};I.updateTitle=function(){f(a,az,0,document.title)};I.bring2Top=function(){ao(a)};I.centerWindow=function(aE,aI){var aH=screen,aF=aH.availWidth,aG=aH.availHeight;if(aE>aF){aE=aF}aI+=ar.btmBarHeight;if(aI>aG){aI=aG}V(a,(aF-aE)/2,(aG-aI)/2,aE,aI,1);ao(a)};I.getWindowRect=function(){var aE=aw();P(a,aE);return aE};I.moveWindow=function(aH,aG,aF,aE){V(a,aH,aG,aF,aE,1)};I.getWindowPlacement=function(){var aE=w();aA(a,aE);return aE};I.setWindowPlacement=function(aE){ah(a,aE)}})();(function(){I.exitCallback=null;var aE=function(){return I.exitCallback?I.exitCallback():true};var aG=Q("WindowHook",a);aG.hookMessage(al,function(aJ,aK,aI,aH){return aE()?aG.CallOriginalWndProc(aJ,aK,aI,aH):0});var aF=r(X,{WindowClosing:function(aI,aH){aH.returnValue=true;if(aE()){ar.closeWindow()}}});ad.attachEvent("onunload",function(){aG.unhook();aF.disconnect()})})();(function(){I.newWindowCallback=null;var aE=r(X,{NewWindow3:function(aH,aK,aG,aJ,aI){var aF=I.newWindowCallback;if(aF&&aF(aH,aK,aG,aJ,aI)){return}var aL=screen;aH.returnValue=LOCALJS.UI.newWindow(aI,aL.availWidth/2-10,aL.availHeight/2-10,10,10,LOCALJS.UI.WS_NO_TITLE_BAR)}});ad.attachEvent("onunload",function(){aE.disconnect()})})()})();