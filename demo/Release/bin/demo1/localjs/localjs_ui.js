(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var O=LOCALJS;if("undefined"!=typeof(O.UI)){return}O.UI={};var b=false,V=true,af=window,al=screen,J=O.UI,av=localJS,a=av.hostWnd,Z=av.webBrowser,B=av.COM,R=B.createObject,m=B.interface2Object,s=B.connectEvents,z=R("DllCall"),t=z.add,q=z.newStruct,p=z.newBuffer,w=function(aI,aH){return"undefined"==typeof(aI)?aH:aI},az=function(){return q().addLong("left").addLong("top").addLong("right").addLong("bottom")},aE=function(){return q().addLong("x").addLong("y")},x=function(){var aH=q().addLong("length").addLong("flags").addLong("showCmd").add(aE(),"ptMinPosition").add(aE(),"ptMaxPosition").add(az(),"rcNormalPosition");aH.length=aH.size;return aH},D=function(){return q().addLong("hwnd").addLong("message").addLong("wParam").addLong("lParam").addLong("time").add(q().addLong("x").addLong("y"),"pt")};t("user32.dll","BOOL GetMessage(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax);");t("user32.dll","BOOL TranslateMessage(const MSG *lpMsg);");t("user32.dll","LRESULT DispatchMessage(const MSG *lpmsg);");t("user32.dll","void PostQuitMessage(int nExitCode);");t("LocalJS.dll","BOOL __stdcall translateBrowserAccelerator(LPMSG lpmsg);");t("user32.dll","LRESULT SendMessage(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam);");t("user32.dll","int WINAPI MessageBox(HWND hWnd,LPCTSTR lpText,LPCTSTR lpCaption,UINT uType);");t("user32.dll","LONG SetWindowLong(HWND hWnd, int nIndex, LONG dwNewLong);");t("user32.dll","BOOL SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags);");t("user32.dll","BOOL SetForegroundWindow(HWND hWnd);");t("user32.dll","BOOL MoveWindow(HWND hWnd,int X,int Y,int nWidth,int nHeight,BOOL bRepaint);");t("user32.dll","BOOL GetWindowRect(HWND hWnd,LPRECT lpRect);");t("user32.dll","BOOL GetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");t("user32.dll","BOOL SetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");t("LocalJS.dll","void * __stdcall createBrowserWindow(DWORD dwStyle, int x, int y, int nWidth, int nHeight, HWND hWndParent, LPCWSTR url, VARIANT * const pVarResult);");t("LocalJS.dll","void __stdcall deleteBrowserWindow(void * browser)");t("LocalJS.dll","void __stdcall detachBrowserWindow(void * browser);");t("LocalJS.dll","IDispatch * __stdcall getBrowserObj(void * browser);");t("LocalJS.dll","BOOL __stdcall browserWindowClosed(void * browser);");t("LocalJS.dll","int __stdcall getBrowserType(void * browser);");t("LocalJS.dll","void * __stdcall createIE(LPCWSTR url);");t("LocalJS.dll","HWND __stdcall getBrowserHostWnd(void * browser);");var e=z.GetMessage,A=z.TranslateMessage,L=z.DispatchMessage,i=z.PostQuitMessage,at=z.translateBrowserAccelerator,g=z.SendMessage,an=z.MessageBox,o=z.SetWindowLong,T=z.SetWindowPos,ar=z.SetForegroundWindow,X=z.MoveWindow,Q=z.GetWindowRect,aD=z.GetWindowPlacement,aj=z.SetWindowPlacement,v=z.createBrowserWindow,l=z.deleteBrowserWindow,G=z.detachBrowserWindow,N=z.getBrowserObj,H=z.browserWindowClosed,M=z.getBrowserHostWnd,ab=z.getBrowserType,c=z.createIE,ag=1,n=2,r=-16,ak=0,aw=2147483648,h=12582912,P=524288,I=131072,aB=65536,au=268435456,E=262144,C=8388608,aF=ak|h|P|E|I|aB,aq=32,K=64,S=2,u=1,d=0,ao=16,aC=12,ap=2,W=16,ai=32,ay=48,aG=64,f=65536,am=8192,ax=262144,aA=1,y=4,ad=256,aa=512,j=W|f|ax|am,F=aG|f|ax|am,ac=ai|f|ax|am|y,ah=ai|f|ax|am|aA,U=1,Y=6,ae=0;J.WS_CLOSE_ONLY=aw|E|h|P|au;J.WS_NO_TITLE_BAR=aw|au|P;J.WS_NORMAL=aF|au;J.isIE=n==ab(av.browserWindowHandle);(function(){var aH=D();unloading=b;af.attachEvent("onunload",function(){unloading=V});J.doEvents=function(){if(unloading){return b}var aI=e(aH,0,0,0);if(0==aI){i(aH.wParam);return b}if(aI>0){if(!at(aH)){A(aH);L(aH)}}return V}})();(function(){var aI,aH=function(aJ){return aJ.getElementsByTagName("html")[0]};J.setDraggables=function(aJ){aI=aJ};J.addDraggable=function(){var aL=0,aK=arguments;for(;aL<aK.length;++aL){var aM=aK[aL];if("string"==typeof(aM)){aM=document.getElementById(aM)}if(aM){if(!aI){aI=[];var aN=document,aJ;if(aN){aI.push(aH(aN));aJ=aN.body}if(aJ){aI.push(aJ)}}aI.push(aM)}}};J.getDraggables=function(){return aI};af.attachEvent("onload",function(){var aS=document,aP=aS.body,aN=aH(aS);if(!aI){aI=[aP,aN]}var aQ=b,aJ=az(),aT,aR,aK,aV,aM=function(aW){if(aI&&aI.length){for(var aX=0;aX<aI.length;++aX){if(aI[aX]===aW){return V}}}return b},aO,aL="onlosecapture",aU=function(){aQ=b;if(aO){aO.detachEvent(aL,aU);aO=null}};aS.attachEvent("onmousedown",function(){aO=event.srcElement;if(!aQ&&(1&event.button)&&aM(aO)&&event.clientX<aN.clientWidth&&event.clientY<aN.clientHeight){aQ=V;aO.setCapture();aO.attachEvent(aL,aU);Q(a,aJ);aK=aJ.right-aJ.left;aV=aJ.bottom-aJ.top;aT=event.screenX;aR=event.screenY}});aS.attachEvent("onmousemove",function(){if(aQ){X(a,aJ.left+event.screenX-aT,aJ.top+event.screenY-aR,aK,aV,1)}});aS.attachEvent("onmouseup",function(){if(aQ&&aO){aO.releaseCapture()}})})})();var k=function(aM){var aJ=aM,aO=this,aH,aN;this.webBrowser=m(N(aJ));this.HWND=M(aJ);this.initFunction=null;this.isIE=n==ab(aJ);this.getHandle=function(){return aJ};this.close=function(aQ){if(aJ){var aP=aJ;aJ=0;aO.webBrowser=null;aO.HWND=0;if(aN){aN.unhook()}if(aH){aH.disconnect()}if(aQ){G(aP)}l(aP)}};this.isClosed=function(){return H(aJ)?V:b};this.getJSWindow=function(aP){aP=w(aP,10);var aQ=(new Date()).getTime()/1000;do{if(aO.webBrowser&&aO.webBrowser.Document){return aO.webBrowser.Document.parentWindow}}while(((new Date()).getTime()/1000)-aQ<aP&&J.doEvents());return undefined};this.getJSVariable=function(aP,aR){aR=w(aR,10);var aS=(new Date()).getTime()/1000,aQ=aO.getJSWindow(aR);if(aQ){while(undefined==aQ[aP]&&((new Date()).getTime()/1000)-aS<aR&&J.doEvents()){}return aQ[aP]}return undefined};var aL=b,aI=function(){if(!aL){var aP=aO.getJSWindow();if(aP){aP.attachEvent("onload",function(){var aQ=aO.initFunction;if(aQ){aQ(aP)}});aP.attachEvent("onunload",function(){aL=b});aL=V}}},aK={DocumentComplete:aI,DownloadComplete:aI,NavigateComplete2:aI};switch(ab(aJ)){case n:aK.OnQuit=function(){aO.close()};break;case ag:aN=R("WindowHook",aO.HWND);aN.hookMessage(ap,function(aR,aS,aQ,aP){aO.close();return aN.CallOriginalWndProc(aR,aS,aQ,aP)});break}aH=s(aO.webBrowser,aK,b)};(function(){J.newWindow=function(aI,aM,aP,aK,aR,aL,aJ,aO,aQ,aH){var aN;aK=w(aK,300);aR=w(aR,180);aM=w(aM,(al.availWidth-aK)>>1);aP=w(aP,(al.availHeight-aR)>>1);if(aH){aN=new k(c(aI));X(aN.HWND,aM,aP,aK,aR,1)}else{if(!aL){aL=J.WS_NORMAL}if(!aJ){aJ=0}aN=new k(v(aL,aM,aP,aK,aR,aJ,aI,0))}if(aO){aN.initFunction=aO}if(!aQ){af.attachEvent("onunload",function(){aN.close()})}return aN}})();(function(){J.msgBox=function(aI,aH){an(a,aI,document.title,aH?j:F)};af.alert=function(aH){J.msgBox(aH,V)};J.confirm=function(aK,aJ,aI){var aH=an(a,aK,document.title,(aI?ah:ac)|(aJ?0:ad));return aI?(aH==U):(aH==Y)};af.confirm=function(aH){return J.confirm(aH)}})();(function(){J.showTitleBar=function(aH){z.SetWindowLong(a,r,aH?J.WS_NO_TITLE_BAR:J.WS_NORMAL);z.SetWindowPos(a,d,0,0,0,0,aq|K|S|u)};J.updateTitle=function(){g(a,aC,0,document.title)};J.bring2Top=function(){ar(a)};J.centerWindow=function(aH,aK){var aI=al.availWidth,aJ=al.availHeight;if(aH>aI){aH=aI}aK+=av.btmBarHeight;if(aK>aJ){aK=aJ}X(a,(aI-aH)/2,(aJ-aK)/2,aH,aK,1);ar(a)};J.getWindowRect=function(){var aH=az();Q(a,aH);return aH};J.moveWindow=function(aK,aJ,aI,aH){X(a,aK,aJ,aI,aH,1)};J.getWindowPlacement=function(){var aH=x();aD(a,aH);return aH};J.setWindowPlacement=function(aH){aj(a,aH)}})();(function(){J.exitCallback=null;var aH=function(){return J.exitCallback?J.exitCallback():V};var aJ=R("WindowHook",a);aJ.hookMessage(ao,function(aM,aN,aL,aK){return aH()?aJ.CallOriginalWndProc(aM,aN,aL,aK):0});var aI=s(Z,{WindowClosing:function(aL,aK){aK.returnValue=V;if(aH()){if(J.isIE){Z.Quit()}else{av.closeWindow()}}}});af.attachEvent("onunload",function(){aJ.unhook();aI.disconnect()})})();(function(){J.newWindowCallback=null;var aH=s(Z,{NewWindow3:function(aK,aN,aJ,aM,aL){var aI=J.newWindowCallback;if(aI&&aI(aK,aN,aJ,aM,aL)){return}var aO=screen;aK.returnValue=LOCALJS.UI.newWindow(aL,aO.availWidth/2-5,aO.availHeight/2-5,10,10,LOCALJS.UI.WS_NO_TITLE_BAR)}});af.attachEvent("onunload",function(){aH.disconnect()})})()})();