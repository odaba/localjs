(function(){if("undefined"==typeof(LOCALJS)){LOCALJS={}}var L=LOCALJS;if("undefined"!=typeof(L.UI)){return}L.UI={};var ab=window,F=L.UI,ar=localJS,a=ar.hostWnd,V=ar.webBrowser,z=ar.COM,O=z.createObject,l=z.interface2Object,r=z.connectEvents,x=O("DllCall"),s=x.add,p=x.newStruct,o=x.newBuffer,u=function(aF,aE){return"undefined"==typeof(aF)?aE:aF},aw=function(){return p().addLong("left").addLong("top").addLong("right").addLong("bottom")},aB=function(){return p().addLong("x").addLong("y")},v=function(){var aE=p().addLong("length").addLong("flags").addLong("showCmd").add(aB(),"ptMinPosition").add(aB(),"ptMaxPosition").add(aw(),"rcNormalPosition");aE.length=aE.size;return aE},B=function(){return p().addLong("hwnd").addLong("message").addLong("wParam").addLong("lParam").addLong("time").add(p().addLong("x").addLong("y"),"pt")};s("user32.dll","BOOL GetMessage(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax);");s("user32.dll","BOOL TranslateMessage(const MSG *lpMsg);");s("user32.dll","LRESULT DispatchMessage(const MSG *lpmsg);");s("user32.dll","void PostQuitMessage(int nExitCode);");s("LocalJS.dll","BOOL __stdcall translateBrowserAccelerator(LPMSG lpmsg);");s("user32.dll","LRESULT SendMessage(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam);");s("user32.dll","int WINAPI MessageBox(HWND hWnd,LPCTSTR lpText,LPCTSTR lpCaption,UINT uType);");s("user32.dll","LONG SetWindowLong(HWND hWnd, int nIndex, LONG dwNewLong);");s("user32.dll","BOOL SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags);");s("user32.dll","BOOL SetForegroundWindow(HWND hWnd);");s("user32.dll","BOOL MoveWindow(HWND hWnd,int X,int Y,int nWidth,int nHeight,BOOL bRepaint);");s("user32.dll","BOOL GetWindowRect(HWND hWnd,LPRECT lpRect);");s("user32.dll","BOOL GetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");s("user32.dll","BOOL SetWindowPlacement(HWND hWnd,WINDOWPLACEMENT *lpwndpl);");s("LocalJS.dll","void * __stdcall createBrowser(DWORD dwStyle, int x, int y, int nWidth, int nHeight, HWND hWndParent, LPCWSTR url, LPCWSTR url_pattern, VARIANT * const pVarResult);");s("LocalJS.dll","void __stdcall deleteBrowser(void * browser)");s("LocalJS.dll","void __stdcall detachBrowser(void * browser);");s("LocalJS.dll","IDispatch * __stdcall getBrowserObj(void * browser);");s("LocalJS.dll","BOOL __stdcall browserRunning(void * browser);");s("LocalJS.dll","int __stdcall getBrowserType(void * browser);");s("LocalJS.dll","void * __stdcall createIE(LPCWSTR url, LPCWSTR url_pattern);");s("LocalJS.dll","HWND __stdcall getBrowserHostWnd(void * browser);");var d=x.GetMessage,y=x.TranslateMessage,H=x.DispatchMessage,h=x.PostQuitMessage,ap=x.translateBrowserAccelerator,f=x.SendMessage,aj=x.MessageBox,n=x.SetWindowLong,Q=x.SetWindowPos,ao=x.SetForegroundWindow,T=x.MoveWindow,N=x.GetWindowRect,aA=x.GetWindowPlacement,af=x.SetWindowPlacement,K=x.createBrowser,ah=x.deleteBrowser,j=x.detachBrowser,J=x.getBrowserObj,an=x.browserRunning,I=x.getBrowserHostWnd,X=x.getBrowserType,b=x.createIE,ac=1,m=2,q=-16,ag=0,at=2147483648,g=12582912,M=524288,E=131072,ay=65536,aq=268435456,C=262144,A=8388608,aC=ag|g|M|C|E|ay,am=32,G=64,P=2,t=1,c=0,ak=16,az=12,al=2,S=16,ae=32,au=48,aD=64,e=65536,ai=8192,av=262144,ax=1,w=4,Z=256,W=512,i=S|e|av|ai,D=aD|e|av|ai,Y=ae|e|av|ai|w,ad=ae|e|av|ai|ax,R=1,U=6,aa=0;F.WS_CLOSE_ONLY=at|C|g|M|aq;F.WS_NO_TITLE_BAR=at|aq|M;F.WS_NORMAL=aC|aq;(function(){var aE=B();unloading=false;ab.attachEvent("onunload",function(){unloading=true});F.doEvents=function(){if(unloading){return false}var aF=d(aE,0,0,0);if(0==aF){h(aE.wParam);return false}if(aF>0){if(!ap(aE)){y(aE);H(aE)}}return true}})();(function(){var aF,aE=function(aG){return aG.getElementsByTagName("html")[0]};F.setDraggables=function(aG){aF=aG};F.addDraggable=function(aH){if(aH){if(!aF){aF=[];var aI=document,aG;if(aI){aF.push(aE(aI));aG=aI.body}if(aG){aF.push(aG)}}aF.push(aH)}};F.getDraggables=function(){return aF};ab.attachEvent("onload",function(){var aP=document,aM=aP.body,aK=aE(aP);if(!aF){aF=[aM,aK]}var aN=false,aG=aw(),aQ,aO,aH,aS,aJ=function(aT){if(aF&&aF.length){for(var aU=0;aU<aF.length;++aU){if(aF[aU]===aT){return true}}}return false},aL,aI="onlosecapture",aR=function(){aN=false;if(aL){aL.detachEvent(aI,aR);aL=null}};aP.attachEvent("onmousedown",function(){aL=event.srcElement;if(!aN&&(1&event.button)&&aJ(aL)&&event.clientX<aK.clientWidth&&event.clientY<aK.clientHeight){aN=true;aL.setCapture();aL.attachEvent(aI,aR);N(a,aG);aH=aG.right-aG.left;aS=aG.bottom-aG.top;aQ=event.screenX;aO=event.screenY}});aP.attachEvent("onmousemove",function(){if(aN){T(a,aG.left+event.screenX-aQ,aG.top+event.screenY-aO,aH,aS,1)}});aP.attachEvent("onmouseup",function(){if(aN&&aL){aL.releaseCapture()}})})})();var k=function(aJ){var aG=aJ,aL=this,aE,aK;this.webBrowser=l(J(aG));this.HWND=I(aG);this.initFunction=null;this.getHandle=function(){return aG};this.close=function(aN){if(aG){var aM=aG;aG=0;aL.webBrowser=null;aL.HWND=0;if(aK){aK.unhook()}if(aE){aE.disconnect()}if(aN){j(aM)}ah(aM)}};this.isRunning=function(){return an(aG)?true:false};this.getJSWindow=function(){if(aL.webBrowser&&aL.webBrowser.Document){return aL.webBrowser.Document.parentWindow}return null};this.getJSVariable=function(aM){var aN=aL.getJSWindow();if(aN){return aN[aM]}return null};var aI=false,aF=function(){if(!aI){var aM=aL.getJSWindow();if(aM){aM.attachEvent("onload",function(){var aN=aL.initFunction;if(aN){aN(aM)}});aM.attachEvent("onunload",function(){aI=false});aI=true}}},aH={DocumentComplete:aF,DownloadComplete:aF,NavigateComplete2:aF};switch(X(aG)){case m:aH.OnQuit=function(){aL.close()};break;case ac:aK=O("WindowHook",aL.HWND);aK.hookMessage(al,function(aO,aP,aN,aM){aL.close();return aK.CallOriginalWndProc(aO,aP,aN,aM)});break}aE=r(aL.webBrowser,aH,false)};(function(){F.newWindow=function(aF,aJ,aN,aH,aP,aI,aG,aM,aO,aL,aE){var aK;aJ=u(aJ,100);aN=u(aN,100);aH=u(aH,300);aP=u(aP,180);aL=u(aL,0);if(aE){aK=new k(b(aF,aL));T(aK.HWND,aJ,aN,aH,aP,1)}else{if(!aI){aI=F.WS_NORMAL}if(!aG){aG=0}aK=new k(K(aI,aJ,aN,aH,aP,aG,aF,aL,0))}if(aM){aK.initFunction=aM}if(!aO){ab.attachEvent("onunload",function(){aK.close()})}return aK}})();(function(){F.msgBox=function(aF,aE){aj(a,aF,document.title,aE?i:D)};ab.alert=function(aE){F.msgBox(aE,true)};F.confirm=function(aH,aG,aF){var aE=aj(a,aH,document.title,(aF?ad:Y)|(aG?0:Z));return aF?(aE==R):(aE==U)};ab.confirm=function(aE){return F.confirm(aE)}})();(function(){F.showTitleBar=function(aE){x.SetWindowLong(a,q,aE?F.WS_NO_TITLE_BAR:F.WS_NORMAL);x.SetWindowPos(a,c,0,0,0,0,am|G|P|t)};F.updateTitle=function(){f(a,az,0,document.title)};F.bring2Top=function(){ao(a)};F.centerWindow=function(aE,aI){var aH=screen,aF=aH.availWidth,aG=aH.availHeight;if(aE>aF){aE=aF}aI+=ar.btmBarHeight;if(aI>aG){aI=aG}T(a,(aF-aE)/2,(aG-aI)/2,aE,aI,1);ao(a)};F.getWindowRect=function(){var aE=aw();N(a,aE);return aE};F.moveWindow=function(aH,aG,aF,aE){T(a,aH,aG,aF,aE,1)};F.getWindowPlacement=function(){var aE=v();aA(a,aE);return aE};F.setWindowPlacement=function(aE){af(a,aE)}})();(function(){F.exitCallback=null;var aE=function(){return F.exitCallback?F.exitCallback():true};var aG=O("WindowHook",a);aG.hookMessage(ak,function(aJ,aK,aI,aH){return aE()?aG.CallOriginalWndProc(aJ,aK,aI,aH):0});var aF=r(V,{WindowClosing:function(aI,aH){aH.returnValue=true;if(aE()){ar.closeWindow()}}});ab.attachEvent("onunload",function(){aG.unhook();aF.disconnect()})})();(function(){F.newWindowCallback=null;var aE=r(V,{NewWindow3:function(aH,aK,aG,aJ,aI){var aF=F.newWindowCallback;if(aF&&aF(aH,aK,aG,aJ,aI)){return}var aL=screen;aH.returnValue=LOCALJS.UI.newWindow(aI,aL.availWidth/2-10,aL.availHeight/2-10,10,10,LOCALJS.UI.WS_NO_TITLE_BAR)}});ab.attachEvent("onunload",function(){aE.disconnect()})})()})();